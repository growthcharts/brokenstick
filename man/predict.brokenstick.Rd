% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict.R
\name{predict.brokenstick}
\alias{predict.brokenstick}
\title{Predict growth curve according to the broken stick model}
\usage{
\method{predict}{brokenstick}(object, y, x, ids = NULL, at = "x", output = "long", ...)
}
\arguments{
\item{object}{An object of class \code{brokenstick} or of class
\code{brokenstick_export}.}

\item{y}{A vector with measurements using the same response scale as the
fitted model.}

\item{x}{A vector with decimal ages of length \code{length(y)}.
If both \code{y} and \code{x} are not specified,
  the function calculates the predicted values for all persons on which
  \code{object} was fitted. If \code{y} is not specified, but \code{x} is,
  then broken stick estimates are obtained at \code{x} for all persons in
  \code{object}. Note that the \code{at = "x"} argument is needed to make
  predictions at the \code{x} values.}

\item{ids}{A vector with one or more subject identification codes.}

\item{at}{If \code{at = "x"} (the default) the function returns
predictions at the \code{x} values in the data. Specify \code{at =
"knots"} to obtain predictions at the knots of the model, or
\code{at = "both"} to obtain both.}

\item{output}{A string specifying the desired type of output. If \code{output
= "long"} (the default), the result is cast into a data frame of the long
format that represents each row represented as an observation. If
\code{output = "broad"}, the result is formed into a broad matrix where
each row represents a person. This format is useful as input to a secondary
data analysis that analyzes the smoothed data as repeated measured. The
format can be used if \code{at = "knots"}, and returns \code{NULL}
otherwise. If \code{output = "vector"}, the result is returned as a vector.
This is the fastest method.}

\item{\dots}{Additional arguments passed down to \code{predict.merMod()},
\code{predict.brokenstick_export()} and \code{predict_all()}.}
}
\value{
If \code{output == "long"}, a data frame with five columns named:
  \describe{
  \item{\code{subjid}}{Person identification}
  \item{\code{x}}{The \code{x} values of the model, usually age}
  \item{\code{y}}{Response values (in scale defined by the model)}
  \item{\code{yhat}}{Predicted values}
  \item{\code{knot}}{Logical, TRUE indicates that the prediction is
  done at the location of the knot, or at a location specified by an
  isolated \code{x} argument, i.e., without a corresponding \code{y} argument.}
  }

  If \code{output == "broad"}, a
  numeric matrix of predicted values with \code{length(slot(object,
  "knots"))} columns. The number of rows will equal the number of
  \code{subjid}'s in the original data. Subject without any valid
  outcome will have \code{NA}'s everywhere.

  If \code{output == "vector"}, a numeric vector of
  predicted values corresponding to the column \code{yhat}.
}
\description{
Calculation predictions (conditional means of the random effects) from the
broken stick model. This function takes an object of class
\code{brokenstick}, and returns predictions in one of several formats. We may
calculate predictions for new persons, i.e., for persons who are not part of
the fitted model, by specifying the \code{x} and \code{y} arguments.
}
\note{
The original data are only present in the \code{object} of class
  \code{brokenstick}. Hence, any calculations involving observations of the
  fitted model require an object of class \code{brokenstick}. Predictions for
  new units can be done both with class \code{brokenstick} and
  \code{brokenstick_export}.
}
\examples{
# Estimates at each measured age for all persons in fitted model
class(fit_206)
p <- predict(fit_206)
head(p)

# Estimates at knots, stored into the broad matrix
p <- predict(fit_206, output = "broad", at = "knots")
round(head(p), 2)

# Get these estimates as a vector, useful for programming
p <- predict(fit_206, output = "vector", at = "knots")
round(head(p), 2)

# Obtain estimates at weeks 1-4 for all children, include old points
p <- predict(fit_206, x = round((1:4) * 7 / 365.25, 4))
head(p)

# Same, but now organised as broad matrix of new points only
p <- predict(fit_206, x = round((1:4) * 7 / 365.25, 4), output = "broad")
head(p)

head(predict(fit_206, at = "knots", output = "broad"), 3)
predict(fit_206, id = c(10001, 10003), at = "knots", output = "broad")
}
\seealso{
Other brokenstick: 
\code{\link{fitted.brokenstick}()},
\code{\link{predict.brokenstick_export}()}
}
\author{
Stef van Buuren 2016
}
\concept{brokenstick}
