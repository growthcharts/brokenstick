<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Data on multiple individuals through time are often sampled at 
    times that differ between persons. Irregular observation times can severely 
    complicate the statistical analysis of the data. The broken stick model 
    approximates each subject’s trajectory by one or more connected line segments. 
    The times at which segments connect (breakpoints) are identical for all 
    subjects and under control of the user. A well-fitting broken stick model 
    effectively transforms individual measurements made at irregular times into 
    regular trajectories with common observation times. Specification of the 
    model requires three variables: time, measurement and subject. The 
    model is a special case of the linear mixed model, with time as a linear 
    B-spline and subject as the grouping factor. The main assumptions are: 
    subjects are exchangeable, trajectories between consecutive breakpoints are 
    straight, random effects follow a multivariate normal distribution, and 
    unobserved data are missing at random. The package contains functions for 
    fitting the broken stick model to data, for predicting curves in new data 
    and for plotting broken stick estimates. The package supports two 
    optimization methods, and includes options to structure the 
    variance-covariance matrix of the random effects. The analyst may use the 
    software to smooth growth curves by a series of connected straight lines, to 
    align irregularly observed curves to a common time grid, to create synthetic 
    curves at a user-specified set of breakpoints, to estimate the time-to-time 
    correlation matrix and to predict future observations. See 
    &lt;doi:10.18637/jss.v106.i07&gt; for additional documentation on background, 
    methodology and applications.">
<title>Broken Stick Model for Irregular Longitudinal Data • brokenstick</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Broken Stick Model for Irregular Longitudinal Data">
<meta property="og:description" content="Data on multiple individuals through time are often sampled at 
    times that differ between persons. Irregular observation times can severely 
    complicate the statistical analysis of the data. The broken stick model 
    approximates each subject’s trajectory by one or more connected line segments. 
    The times at which segments connect (breakpoints) are identical for all 
    subjects and under control of the user. A well-fitting broken stick model 
    effectively transforms individual measurements made at irregular times into 
    regular trajectories with common observation times. Specification of the 
    model requires three variables: time, measurement and subject. The 
    model is a special case of the linear mixed model, with time as a linear 
    B-spline and subject as the grouping factor. The main assumptions are: 
    subjects are exchangeable, trajectories between consecutive breakpoints are 
    straight, random effects follow a multivariate normal distribution, and 
    unobserved data are missing at random. The package contains functions for 
    fitting the broken stick model to data, for predicting curves in new data 
    and for plotting broken stick estimates. The package supports two 
    optimization methods, and includes options to structure the 
    variance-covariance matrix of the random effects. The analyst may use the 
    software to smooth growth curves by a series of connected straight lines, to 
    align irregularly observed curves to a common time grid, to create synthetic 
    curves at a user-specified set of breakpoints, to estimate the time-to-time 
    correlation matrix and to predict future observations. See 
    &lt;doi:10.18637/jss.v106.i07&gt; for additional documentation on background, 
    methodology and applications.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">brokenstick</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/brokenstick.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/mainfunctions.html">Overview of main functions</a>
    <a class="dropdown-item" href="articles/manual/manual.html">Broken Stick Model for Irregular Longitudinal Data</a>
    <a class="dropdown-item" href="articles/perfectmodel.html">Check perfect model</a>
    <a class="dropdown-item" href="articles/oldfriends.html">Help for old friends</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/growthcharts/brokenstick/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="brokenstick">brokenstick<a class="anchor" aria-label="anchor" href="#brokenstick"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The broken stick model describes a set of individual curves by a linear mixed model using second-order linear B-splines. The main use of the model is to align irregularly observed data to a user-specified grid of break ages.</p>
<p>All fitting can done in the Z-score scale, so nonlinearities and irregular data can be treated as separate problems. This package contains functions for fitting a broken stick model to data, for exporting the parameters of the model for independent use outside this package, and for predicting broken stick curves for new data.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the <code>brokenstick</code> package from CRAN as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"brokenstick"</span><span class="op">)</span></span></code></pre></div>
<p>The latest version (revision branch) can be installed from GitHub as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"growthcharts/brokenstick"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <em>broken stick model</em> describes a set of individual curves by a linear mixed model using linear B-splines. The model can be used</p>
<ul>
<li>to smooth growth curves by a series of connected straight lines;</li>
<li>to align irregularly observed curves to a common age grid;</li>
<li>to create synthetic curves at a user-specified set of break ages;</li>
<li>to estimate the time-to-time correlation matrix;</li>
<li>to predict future observations.</li>
</ul>
<p>The user specifies a set of break ages at which the straight lines connect. Each individual obtains an estimate at each break age, so the set of estimates of the individual form a smoothed version of the observed trajectory.</p>
<p>The main assumptions of the broken stick model are:</p>
<ul>
<li>The trajectory between the break ages follows a straight line, and is generally not of particular interest;</li>
<li>Broken stick estimates follow a common multivariate normal distribution;</li>
<li>Missing data are missing at random (MAR);</li>
<li>Individuals are exchangeable and uncorrelated.</li>
</ul>
<p>In order to conform to the assumption of multivariate normality, the user may fit the broken stick model on suitably transformed data that yield the standard normal (<span class="math inline"><em>Z</em></span>) scale. Unique feature of the broken stick model are:</p>
<ul>
<li>
<em>Modular</em>: Issues related to non-linearity of the growth curves in the observed scale can be treated separately, i.e., outside the broken stick model;</li>
<li>
<em>Local</em>: A given data point will contribute only to the estimates corresponding to the closest break ages;</li>
<li>
<em>Exportable</em>: The broken stick model can be exported and reused for prediction for new data in alternative computing environments.</li>
</ul>
<p>The <code>brokenstick</code> package contains functions for</p>
<ul>
<li>Fitting the broken stick model to data,</li>
<li>Plotting individual trajectories,</li>
<li>Predicting broken stick estimates for new data.</li>
</ul>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<ol style="list-style-type: decimal">
<li>I took the name <em>broken stick</em> from Ruppert, Wand, and Carroll (<a href="#ref-ruppert2003">2003</a>), page 59-61, but it is actually much older.</li>
<li>As far as I know, de Kroon et al. (<a href="#ref-dekroon2010">2010</a>) is the first publication that uses the broken stick model without the intercept in a mixed modelling context. See <a href="https://stefvanbuuren.name/publications/2010%20TBC%20Overweight%20-%20PLoS%20ONE.pdf" class="external-link">The Terneuzen birth cohort: BMI changes between 2 and 6 years correlate strongest with adult overweight</a>.</li>
<li>The model was formally defined and extended in <a href="https://stefvanbuuren.name/fimd/sec-rastering.html#sec:brokenstick" class="external-link">Flexible Imputation of Missing Data (second edition)</a>. See van Buuren (<a href="#ref-vanbuuren2018">2018</a>).</li>
<li>The evaluation by Anderson et al. (<a href="#ref-anderson2019">2019</a>) concluded:</li>
</ol>
<blockquote>
<blockquote>
<p>We recommend the use of the brokenstick model with standardised Z‐score data. Aside from the accuracy of the fit, another key advantage of the brokenstick model is that it is easier to fit and provides easily interpretable estimates of child growth trajectories.</p>
</blockquote>
</blockquote>
</div>
<div class="section level3">
<h3 id="instructive-materials">Instructive materials<a class="anchor" aria-label="anchor" href="#instructive-materials"></a>
</h3>
<ul>
<li>Publication: S. van Buuren (2023), Broken Stick Model for Irregular Longitudinal Data. <em>Journal of Statistical Software</em>, 106(7), 1–51. <a href="https://doi.org/10.18637/jss.v106.i07" class="external-link">doi:10.18637/jss.v106.i07</a><a href="https://growthcharts.org/brokenstick/articles/manual/manual.html">html</a>;</li>
<li>
<a href="https://growthcharts.org/brokenstick/">Companion site</a> contains vignettes and articles that explain the model and the use of the software.</li>
</ul>
</div>
<div class="section level3">
<h3 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h3>
<p>This work was supported by the Bill &amp; Melinda Gates Foundation. The contents are the sole responsibility of the authors and may not necessarily represent the official views of the Bill &amp; Melinda Gates Foundation or other agencies that may have supported the primary data studies used in the present study.</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anderson2019" class="csl-entry">
Anderson, C., R. Hafen, O. Sofrygin, L. Ryan, and HBGDki Community. 2019. “Comparing Predictive Abilities of Longitudinal Child Growth Models.” <em>Statistics in Medicine</em> 38 (19): 3555–70. <a href="https://doi.org/10.1002/sim.7693" class="external-link uri">https://doi.org/10.1002/sim.7693</a>.
</div>
<div id="ref-dekroon2010" class="csl-entry">
de Kroon, M. L. A., C. M. Renders, J. P. van Wouwe, S. van Buuren, and R. A. Hirasing. 2010. “The Terneuzen Birth Cohort: BMI Changes Between 2 and 6 Years Correlate Strongest with Adult Overweight.” <em>PLOS One</em> 5 (2): e9155. <a href="https://doi.org/10.1371/journal.pone.0009155" class="external-link uri">https://doi.org/10.1371/journal.pone.0009155</a>.
</div>
<div id="ref-ruppert2003" class="csl-entry">
Ruppert, D., M. P. Wand, and R. J. Carroll. 2003. <em>Semiparametric Regression</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-vanbuuren2018" class="csl-entry">
van Buuren, S. 2018. <em>Flexible Imputation of Missing Data</em>. 2nd ed. Boca Raton, FL: CRC Press. <a href="https://stefvanbuuren.name/fimd" class="external-link uri">https://stefvanbuuren.name/fimd</a>.
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=brokenstick" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/growthcharts/brokenstick/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/growthcharts/brokenstick/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing brokenstick</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://stefvanbuuren.name" class="external-link">Stef van Buuren</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://cran.r-project.org/package=brokenstick" class="external-link"><img src="https://www.r-pkg.org/badges/version/brokenstick" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://growthcharts.org/brokenstick/"><img src="https://img.shields.io/badge/github%20version-2.5.0-orange.svg"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://stefvanbuuren.name" class="external-link">Stef van Buuren</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
