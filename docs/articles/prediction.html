<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit and predict â€¢ brokenstick</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit and predict">
<meta property="og:description" content="brokenstick">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brokenstick</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.61.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gettingstarted.html">Getting started with `brokenstick`</a>
    </li>
    <li>
      <a href="../articles/knotplacement.html">Knot placement</a>
    </li>
    <li>
      <a href="../articles/mainfunctions.html">Overview of main functions</a>
    </li>
    <li>
      <a href="../articles/model.html">Model formulation</a>
    </li>
    <li>
      <a href="../articles/perfectmodel.html">Check perfect model</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Fit and predict</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="prediction_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="prediction_files/bokehjs-0.12.5/bokeh.min.css" rel="stylesheet">
<link href="prediction_files/bokehjs-0.12.5/loader.css" rel="stylesheet">
<script src="prediction_files/bokehjs-0.12.5/bokeh.min.js"></script><script src="prediction_files/rbokeh-binding-0.5.1/rbokeh.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit and predict</h1>
                        <h4 class="author">Stef van Buuren</h4>
            
            <h4 class="date">2020-05-11</h4>
      
      
      <div class="hidden name"><code>prediction.Rmd</code></div>

    </div>

    
    
<div id="objective" class="section level2">
<h2 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h2>
<p>This vignette shows a step-by-step introduction of how to - Fit the broken stick model to data; - Predict observations by the fitted model.</p>
</div>
<div id="get-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#get-the-data" class="anchor"></a>Get the data</h2>
<p>This vignette assumes the <code>rbokeh</code>, <code>AGD</code>, <code>brokenstick</code> packages are installed. See <a href="gettingstarted.html">getting started with <code>brokenstick</code></a> for the installation procedure. We will use the <code>smocc_50</code> demo data that is built-in into the <code>brokenstick</code> package.</p>
</div>
<div id="calculate-z-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-z-scores" class="anchor"></a>Calculate <span class="math inline">\(Z\)</span>-scores</h2>
<p>The broken stick model can fit observations in either the raw scale (cm, kg, and so on) or as a standard deviation score (SDS), or <span class="math inline">\(Z\)</span>-score. The results from the analysis of the <span class="math inline">\(Z\)</span>-score is preferable for several reasons:</p>
<ol style="list-style-type: decimal">
<li>for growth curves, a straight line assumption is more plausible in the <span class="math inline">\(Z\)</span>-score scale;</li>
<li>the assumption of normality is more plausible in the <span class="math inline">\(Z\)</span>-score scale;</li>
<li>fitting the <span class="math inline">\(Z\)</span>-score data leads to less convergence issues.</li>
</ol>
<p>It is easy to convert the measurements into the <span class="math inline">\(Z\)</span>-score scale, fit the model, and convert back to the raw scale afterwards, if desired. There are several <code>R</code> packages that assist in the calculations: <a href="https://cran.r-project.org/web/packages/AGD/index.html">AGD</a>, <a href="https://cran.r-project.org/web/packages/anthro/index.html">anthro</a>, <a href="https://cran.r-project.org/web/packages/childsds/index.html">childsds</a>, <a href="https://github.com/ki-tools/growthstandards">growthstandards</a> and <a href="https://cran.r-project.org/web/packages/zscorer/index.html">zscorer</a>.</p>
<p>Here we use 50 children from the SMOCC data <span class="citation">[@herngreen1994]</span>. The <code>smocc_50</code> data contains the height measurement both in the original scale in cm (<code>hgt</code>) and the Z-score scale (<code>hgt.z</code>) as calculated against the growth references of the Fourth Dutch Growth study <span class="citation">[@fredriks2000]</span>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">brokenstick</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">smocc_50</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">data</span>)</pre></body></html></div>
<pre><code>## # A tibble: 6 x 5
##   subjid    age sex      hgt  hgt.z
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1  10001 0      female  52    0.575
## 2  10001 0.0821 female  55.6  0.888
## 3  10001 0.159  female  58.2  0.797
## 4  10001 0.255  female  61.2  0.661
## 5  10001 0.504  female  67.2  0.290
## 6  10001 0.753  female  70.2 -0.398</code></pre>
<div class="figure">
<div id="htmlwidget-253139bdeb31b1dcb80f" style="width:700px;height:432.632880098888px;" class="rbokeh html-widget"></div>
<script type="application/json" data-for="htmlwidget-253139bdeb31b1dcb80f">{"x":{"elementid":"5dfe7a6849c4998b4c3a2ab3945f212d","modeltype":"Plot","modelid":"6598b4f4cd4062ae3af50ce65100ad87","docid":"588aeb900eaf237306fa6191af22c27a","docs_json":{"588aeb900eaf237306fa6191af22c27a":{"version":"0.12.5","title":"Bokeh Figure","roots":{"root_ids":["6598b4f4cd4062ae3af50ce65100ad87"],"references":[{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","attributes":{"id":"6598b4f4cd4062ae3af50ce65100ad87","sizing_mode":"scale_both","x_range":{"type":"Range1d","id":"d7d196b07b2a22b10cb73bd0bbf37993"},"y_range":{"type":"Range1d","id":"1c664e0e95a75b9efc55cfdedc43894a"},"left":[{"type":"LinearAxis","id":"7966aabbf8de1afde6f2c1ee8e90cb51"}],"below":[{"type":"LinearAxis","id":"e9d350ea094f4c0e01f87920ae371c35"}],"right":[],"above":[],"renderers":[{"type":"BoxAnnotation","id":"35845c10f33548631b9bc14ec0a0647e"},{"type":"GlyphRenderer","id":"f1d854522edf5c04c166e90c3df387b5"},{"type":"LinearAxis","id":"e9d350ea094f4c0e01f87920ae371c35"},{"type":"Grid","id":"300657c830aa3fd3bf21f416d2f46ef2"},{"type":"LinearAxis","id":"7966aabbf8de1afde6f2c1ee8e90cb51"},{"type":"Grid","id":"5cc00492c1dee29b8807cce1d6e02195"}],"extra_y_ranges":{},"extra_x_ranges":{},"tags":[],"min_border_left":4,"min_border_right":4,"min_border_top":4,"min_border_bottom":4,"lod_threshold":null,"toolbar":{"type":"Toolbar","id":"23516f7588daadc71f5310d2906c32c1"},"tool_events":{"type":"ToolEvents","id":"d7557c33538d00975b5351d13e47c8bc"}},"subtype":"Figure"},{"type":"Toolbar","id":"23516f7588daadc71f5310d2906c32c1","attributes":{"id":"23516f7588daadc71f5310d2906c32c1","tags":[],"active_drag":"auto","active_scroll":"auto","active_tap":"auto","tools":[{"type":"PanTool","id":"52ffa067fef5e695edf52507b44d0b0c"},{"type":"WheelZoomTool","id":"7125bf097d917b6c53c430a60dd0135f"},{"type":"BoxZoomTool","id":"3ce2b9c783136eea0c3c6ca90ecf45e6"},{"type":"ResetTool","id":"d98d043d25a3a673e24cfdd4974ea414"},{"type":"SaveTool","id":"f2dc67a2fbff573efe22f674d06c2ce3"},{"type":"HelpTool","id":"72be8b54961ea5bb0dd3499bedfcebe7"},{"type":"HoverTool","id":"27d046ad9168a08f6201975c95370300"}],"logo":null}},{"type":"PanTool","id":"52ffa067fef5e695edf52507b44d0b0c","attributes":{"id":"52ffa067fef5e695edf52507b44d0b0c","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"dimensions":"both"}},{"type":"ToolEvents","id":"d7557c33538d00975b5351d13e47c8bc","attributes":{"id":"d7557c33538d00975b5351d13e47c8bc","tags":[]},"geometries":[]},{"type":"WheelZoomTool","id":"7125bf097d917b6c53c430a60dd0135f","attributes":{"id":"7125bf097d917b6c53c430a60dd0135f","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"dimensions":"both"}},{"type":"BoxAnnotation","id":"35845c10f33548631b9bc14ec0a0647e","attributes":{"id":"35845c10f33548631b9bc14ec0a0647e","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"fill_color":{"units":"data","value":"lightgrey"},"fill_alpha":{"units":"data","value":0.5},"line_dash":[4,4],"line_width":{"units":"data","value":2},"level":"overlay","top_units":"screen","bottom_units":"screen","left_units":"screen","right_units":"screen","render_mode":"css"}},{"type":"BoxZoomTool","id":"3ce2b9c783136eea0c3c6ca90ecf45e6","attributes":{"id":"3ce2b9c783136eea0c3c6ca90ecf45e6","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"overlay":{"type":"BoxAnnotation","id":"35845c10f33548631b9bc14ec0a0647e"}}},{"type":"ResetTool","id":"d98d043d25a3a673e24cfdd4974ea414","attributes":{"id":"d98d043d25a3a673e24cfdd4974ea414","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"}}},{"type":"SaveTool","id":"f2dc67a2fbff573efe22f674d06c2ce3","attributes":{"id":"f2dc67a2fbff573efe22f674d06c2ce3","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"}}},{"type":"HelpTool","id":"72be8b54961ea5bb0dd3499bedfcebe7","attributes":{"id":"72be8b54961ea5bb0dd3499bedfcebe7","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"redirect":"http://hafen.github.io/rbokeh","help_tooltip":"Click to learn more about rbokeh."}},{"type":"HoverTool","id":"27d046ad9168a08f6201975c95370300","attributes":{"id":"27d046ad9168a08f6201975c95370300","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"renderers":[{"type":"GlyphRenderer","id":"f1d854522edf5c04c166e90c3df387b5"}],"names":[],"anchor":"center","attachment":"horizontal","line_policy":"prev","mode":"mouse","point_policy":"snap_to_data","tooltips":[["data$age","@hover_col_1"],["data$hgt","@hover_col_2"],["data$hgt.z","@hover_col_3"]]}},{"type":"ColumnDataSource","id":"555f1d4bb875d4f3d22848c951d06467","attributes":{"id":"555f1d4bb875d4f3d22848c951d06467","tags":[],"column_names":["x","y","hover_col_1","hover_col_2","hover_col_3"],"selected":[],"data":{"x":[0,0.0821,0.1588,0.2546,0.5038,0.7529,1.0021,1.1745,1.5661,2.0096,0,0.1123,0.1506,0.2464,0.4956,0.7447,0.9938,1.5195,1.9603,0,0.0739,0.1506,0.2847,0.4956,0.7447,0.9938,1.1663,1.5195,2.0014,0,0.0657,0.1615,0.2382,0.5257,0.7365,0.9856,1.2731,1.5113,2.0096,0,0.0903,0.1478,0.2628,0.512,0.7611,1.0103,1.2019,1.4976,2.0342,0,0.063,0.1588,0.2355,0.5229,0.7721,1.0212,1.1937,1.5086,1.9904,0,0.0767,0.1342,0.2491,0.4983,0.7474,1.0157,1.2457,1.4839,2.0205,0,0.0767,0.1533,0.23,0.4983,0.7091,0.9774,1.4949,2.0972,0,0.0794,0.1561,0.271,0.501,0.7885,1.0103,1.2485,1.6016,2.0041,0,0.0739,0.1506,0.2272,0.4956,0.7447,1.1472,1.2047,1.5003,1.9603,0,0.0767,0.1916,0.2683,0.5366,0.7858,1.0075,1.2457,1.5031,1.9849,0,0.0739,0.1506,0.2656,0.4956,0.7064,1.0048,1.243,1.5387,2.0945,0,0.0767,0.1533,0.3066,0.4791,0.7666,0.9774,1.2266,1.744,2.0041,0,0.0849,0.1807,0.2765,0.4873,0.8433,1.024,1.2348,1.4538,2.0698,0,0.0794,0.1561,0.271,0.501,0.731,1.0185,1.191,1.4867,1.9466,0,0.0657,0.1807,0.2765,0.4983,0.7365,1.024,1.2731,1.5113,2.0096,0,0.1506,0.2464,0.5147,0.7447,0.9938,1.243,1.462,2.078,0,0.0986,0.1944,0.271,0.4928,0.7693,1.0185,2.1191,0,0.0876,0.1451,0.2601,0.501,0.7693,1.065,1.2567,1.514,2.0507,0,0.0821,0.1588,0.2546,0.4956,0.7639,1.0021,1.5469,2.0068,0,0.0821,0.1396,0.2546,0.5038,0.7912,1.0021,1.1745,1.5661,2.0096,0,0.0657,0.1615,0.2765,0.5257,0.7365,0.9856,1.2731,1.5606,2.0096,0,0.1068,0.1643,0.2409,0.4901,0.7392,1.0267,1.2375,1.514,1.9959,0,0.0767,0.1342,0.2683,0.4983,0.7474,1.0541,1.2457,1.4839,1.9658,0,0.0657,0.1615,0.2574,0.6023,0.8049,1.0431,1.2923,1.5222,2.0862,0,0.1068,0.1834,0.2793,0.4901,0.7392,1.065,1.2758,1.4949,2.1109,0,0.0931,0.1697,0.3422,0.5339,0.7639,1.0322,1.5195,2.0178,0,0.104,0.1807,0.2765,0.5257,0.7556,1.0431,1.2539,1.473,2.0507,0,0.0767,0.1533,0.2491,0.5175,0.7474,1.0157,1.2457,1.5031,2.0424,0,0.0876,0.1643,0.2601,0.5284,0.7392,1.4565,2.0342,0,0.0849,0.1424,0.2683,0.5065,0.7556,1.0048,1.2539,1.4949,2.0123,0,0.0876,0.1834,0.271,0.5092,0.7584,1.0075,1.2375,1.514,2.0315,0,0.0849,0.1424,0.2683,0.5448,0.7556,1.0048,1.2923,1.4949,2.0287,0,0.0876,0.2026,0.2601,0.5092,0.7584,1.0075,1.2676,1.4757,2.0534,0,0.0903,0.167,0.2546,0.5311,0.7611,0.9911,1.4127,1.4976,2.1027,0,0.0849,0.1424,0.2574,0.5065,0.7556,1.0048,1.2539,1.5688,2.0507,0,0.0821,0.1588,0.2738,0.5229,0.7529,1.0021,1.3087,1.5852,2.0287,0,0.0958,0.1533,0.2491,0.4983,0.7474,0.9966,1.2567,1.5606,2.0698,0,0.0931,0.1807,0.2847,0.4873,0.7447,1.0322,1.2813,1.5195,1.9795,0,0.0657,0.1916,0.23,0.4682,0.7365,1.0048,1.2923,1.5277,1.9904,0,0.1177,0.167,0.3285,0.5202,0.7693,0.9802,0,0.0684,0.1561,0.2601,0.5092,0.7775,1.065,1.2567,1.5332,2.0315,0,0.0931,0.1697,0.2656,0.4956,0.7447,0.9938,1.243,1.4812,2.0178,0,0.104,0.1725,0.2574,0.5065,0.7556,1.0048,1.2539,1.5332,2.0315,0,0.0958,0.1615,0.2574,0.4873,0.7173,1.0048,1.2539,1.4949,1.9932,0,0.0958,0.1615,0.2574,0.5175,0.7556,1.0431,1.3306,1.473,0,0.1971,0.293,0.4654,0.7529,0.9637,1.2895,1.5086,2.0068,0,0.0739,0.1697,0.2656,0.4956,0.8405,1.013,1.2238,1.5195,2.0178,0,0.0986,0.1752,0.271,0.5585,0.7885,1.0185,1.2676,1.4702,2.0233,0,0.0986,0.1561,0.2519,0.4819,0.731,1.0185,1.2485,1.5825,2.026],"y":[52,55.6,58.2,61.2,67.2,70.2,75.7,78.5,81.8,88.3,51,55.1,57,60.2,67.5,71.9,75.5,82,86,53,57.7,60.5,65.1,71.3,76,78.6,80.5,84.2,91.5,51,54,57.3,61.3,68.5,72.5,75.9,78.5,81,87,null,59.1,60.7,63.8,70,75.5,81.6,86.2,90,96,50,53.8,57.5,62,68.3,72.5,75.5,79,85,90,51,55.5,58.5,62.6,70,74.7,78,80.5,82.7,90.5,54,54.7,58.4,60.5,67.3,72,77,84,91.5,54,57,59.5,64.5,70.2,74,77,79.9,83.5,89.5,53,55.5,61,63.6,70.7,75,80,82,87.5,95,50,54.1,59.1,61,67.8,71,77.1,78.4,83,90,52,54.5,55,59.6,62,66,68.5,71.5,74.5,82,52,55.9,57,62.2,68,72.7,77,80.2,86.5,89.5,51,57,61.4,62.5,68.6,74,75,79.6,82.5,90,53,55.7,58.5,64,72,75.4,79,80,84,90,47,52,56.7,60.8,65.5,68,73.2,80,81.5,87,45,52,56,65,69.5,74,79.2,82,89.9,49,52.4,56.5,59.2,64.4,68.8,72.5,82.5,49,55.2,57,61.3,68.3,70,76.3,77,82.5,90,49,53.5,57,60.2,66.4,70.5,73,80,86.5,53,55.3,57,63.3,67.4,70.7,74.2,77,81,86,50,50.4,54,58.4,64.2,68.2,71.6,73.3,76.2,78.5,52,56,59.5,62,69.5,74.5,78.5,81,84.2,90,52,57,62.5,63.5,71,74,78,80.4,82.5,89.5,50,55,59.6,63.5,70.2,73.5,77.9,82,83,90,55,59,61.2,64.2,68.7,73.4,80,85.5,85.5,94.5,51,55.5,59,65,69,72.3,76.5,82.6,88,51,59,60.8,65.2,72.5,75.2,80,82.4,85,92.5,53,58,60,64.5,71,76,80,82.7,86,92,55,58,62.2,65,72.7,77.7,87.8,94.5,52,56,58.2,61.5,68,71.5,74,77,81,88.4,50,55.5,59.5,62.6,68.5,71.5,76,79,81.5,88,54,58,61,64.5,71,73.7,78,82.5,84,89,48,50.3,53.5,56.5,61,66,70,74.2,75.1,83.5,52,58,60.5,64.8,69.5,75,75,84,86.5,95,53,56,57.4,60.8,67,72,77,78,84.5,87.5,51,55.6,59.5,62.5,70.5,73.3,76.2,83,87,91,49,52.5,53.7,57,63.8,68,71,76.5,78.2,84,53,57,60,62.3,69.5,73.8,80.5,84.5,87.5,91,null,52.2,57,57.9,65.3,70,76,79,81,86.5,47,55,57,62.4,67,70.9,75,51,54.2,55.5,59.5,66,72,78,80,82.4,87.5,51,55.5,56,59.5,65.5,69.5,75.3,78.5,81.5,86,50,55,58.5,61.6,66.5,70,75.5,79.5,83,89.5,51,55.5,56.5,60,65.3,69.9,75,79.5,82.5,86.7,45,53.5,55.5,60.5,69.5,74,77.2,82.5,84.3,44,51.5,55.3,62.2,68.6,74,80,81.5,89.2,52,54,58.8,61,65.3,70.5,74,77.2,82.5,88.5,51,54,56.5,59.5,66,70,74.6,78.5,80.3,86,52,56.1,57.5,63.5,67.7,71.3,74.5,79.4,83,87.5],"hover_col_1":["0.0000","0.0821","0.1588","0.2546","0.5038","0.7529","1.0021","1.1745","1.5661","2.0096","0.0000","0.1123","0.1506","0.2464","0.4956","0.7447","0.9938","1.5195","1.9603","0.0000","0.0739","0.1506","0.2847","0.4956","0.7447","0.9938","1.1663","1.5195","2.0014","0.0000","0.0657","0.1615","0.2382","0.5257","0.7365","0.9856","1.2731","1.5113","2.0096","0.0000","0.0903","0.1478","0.2628","0.5120","0.7611","1.0103","1.2019","1.4976","2.0342","0.0000","0.0630","0.1588","0.2355","0.5229","0.7721","1.0212","1.1937","1.5086","1.9904","0.0000","0.0767","0.1342","0.2491","0.4983","0.7474","1.0157","1.2457","1.4839","2.0205","0.0000","0.0767","0.1533","0.2300","0.4983","0.7091","0.9774","1.4949","2.0972","0.0000","0.0794","0.1561","0.2710","0.5010","0.7885","1.0103","1.2485","1.6016","2.0041","0.0000","0.0739","0.1506","0.2272","0.4956","0.7447","1.1472","1.2047","1.5003","1.9603","0.0000","0.0767","0.1916","0.2683","0.5366","0.7858","1.0075","1.2457","1.5031","1.9849","0.0000","0.0739","0.1506","0.2656","0.4956","0.7064","1.0048","1.2430","1.5387","2.0945","0.0000","0.0767","0.1533","0.3066","0.4791","0.7666","0.9774","1.2266","1.7440","2.0041","0.0000","0.0849","0.1807","0.2765","0.4873","0.8433","1.0240","1.2348","1.4538","2.0698","0.0000","0.0794","0.1561","0.2710","0.5010","0.7310","1.0185","1.1910","1.4867","1.9466","0.0000","0.0657","0.1807","0.2765","0.4983","0.7365","1.0240","1.2731","1.5113","2.0096","0.0000","0.1506","0.2464","0.5147","0.7447","0.9938","1.2430","1.4620","2.0780","0.0000","0.0986","0.1944","0.2710","0.4928","0.7693","1.0185","2.1191","0.0000","0.0876","0.1451","0.2601","0.5010","0.7693","1.0650","1.2567","1.5140","2.0507","0.0000","0.0821","0.1588","0.2546","0.4956","0.7639","1.0021","1.5469","2.0068","0.0000","0.0821","0.1396","0.2546","0.5038","0.7912","1.0021","1.1745","1.5661","2.0096","0.0000","0.0657","0.1615","0.2765","0.5257","0.7365","0.9856","1.2731","1.5606","2.0096","0.0000","0.1068","0.1643","0.2409","0.4901","0.7392","1.0267","1.2375","1.5140","1.9959","0.0000","0.0767","0.1342","0.2683","0.4983","0.7474","1.0541","1.2457","1.4839","1.9658","0.0000","0.0657","0.1615","0.2574","0.6023","0.8049","1.0431","1.2923","1.5222","2.0862","0.0000","0.1068","0.1834","0.2793","0.4901","0.7392","1.0650","1.2758","1.4949","2.1109","0.0000","0.0931","0.1697","0.3422","0.5339","0.7639","1.0322","1.5195","2.0178","0.0000","0.1040","0.1807","0.2765","0.5257","0.7556","1.0431","1.2539","1.4730","2.0507","0.0000","0.0767","0.1533","0.2491","0.5175","0.7474","1.0157","1.2457","1.5031","2.0424","0.0000","0.0876","0.1643","0.2601","0.5284","0.7392","1.4565","2.0342","0.0000","0.0849","0.1424","0.2683","0.5065","0.7556","1.0048","1.2539","1.4949","2.0123","0.0000","0.0876","0.1834","0.2710","0.5092","0.7584","1.0075","1.2375","1.5140","2.0315","0.0000","0.0849","0.1424","0.2683","0.5448","0.7556","1.0048","1.2923","1.4949","2.0287","0.0000","0.0876","0.2026","0.2601","0.5092","0.7584","1.0075","1.2676","1.4757","2.0534","0.0000","0.0903","0.1670","0.2546","0.5311","0.7611","0.9911","1.4127","1.4976","2.1027","0.0000","0.0849","0.1424","0.2574","0.5065","0.7556","1.0048","1.2539","1.5688","2.0507","0.0000","0.0821","0.1588","0.2738","0.5229","0.7529","1.0021","1.3087","1.5852","2.0287","0.0000","0.0958","0.1533","0.2491","0.4983","0.7474","0.9966","1.2567","1.5606","2.0698","0.0000","0.0931","0.1807","0.2847","0.4873","0.7447","1.0322","1.2813","1.5195","1.9795","0.0000","0.0657","0.1916","0.2300","0.4682","0.7365","1.0048","1.2923","1.5277","1.9904","0.0000","0.1177","0.1670","0.3285","0.5202","0.7693","0.9802","0.0000","0.0684","0.1561","0.2601","0.5092","0.7775","1.0650","1.2567","1.5332","2.0315","0.0000","0.0931","0.1697","0.2656","0.4956","0.7447","0.9938","1.2430","1.4812","2.0178","0.0000","0.1040","0.1725","0.2574","0.5065","0.7556","1.0048","1.2539","1.5332","2.0315","0.0000","0.0958","0.1615","0.2574","0.4873","0.7173","1.0048","1.2539","1.4949","1.9932","0.0000","0.0958","0.1615","0.2574","0.5175","0.7556","1.0431","1.3306","1.4730","0.0000","0.1971","0.2930","0.4654","0.7529","0.9637","1.2895","1.5086","2.0068","0.0000","0.0739","0.1697","0.2656","0.4956","0.8405","1.0130","1.2238","1.5195","2.0178","0.0000","0.0986","0.1752","0.2710","0.5585","0.7885","1.0185","1.2676","1.4702","2.0233","0.0000","0.0986","0.1561","0.2519","0.4819","0.7310","1.0185","1.2485","1.5825","2.0260"],"hover_col_2":["52.0","55.6","58.2","61.2","67.2","70.2","75.7","78.5","81.8","88.3","51.0","55.1","57.0","60.2","67.5","71.9","75.5","82.0","86.0","53.0","57.7","60.5","65.1","71.3","76.0","78.6","80.5","84.2","91.5","51.0","54.0","57.3","61.3","68.5","72.5","75.9","78.5","81.0","87.0","  NA","59.1","60.7","63.8","70.0","75.5","81.6","86.2","90.0","96.0","50.0","53.8","57.5","62.0","68.3","72.5","75.5","79.0","85.0","90.0","51.0","55.5","58.5","62.6","70.0","74.7","78.0","80.5","82.7","90.5","54.0","54.7","58.4","60.5","67.3","72.0","77.0","84.0","91.5","54.0","57.0","59.5","64.5","70.2","74.0","77.0","79.9","83.5","89.5","53.0","55.5","61.0","63.6","70.7","75.0","80.0","82.0","87.5","95.0","50.0","54.1","59.1","61.0","67.8","71.0","77.1","78.4","83.0","90.0","52.0","54.5","55.0","59.6","62.0","66.0","68.5","71.5","74.5","82.0","52.0","55.9","57.0","62.2","68.0","72.7","77.0","80.2","86.5","89.5","51.0","57.0","61.4","62.5","68.6","74.0","75.0","79.6","82.5","90.0","53.0","55.7","58.5","64.0","72.0","75.4","79.0","80.0","84.0","90.0","47.0","52.0","56.7","60.8","65.5","68.0","73.2","80.0","81.5","87.0","45.0","52.0","56.0","65.0","69.5","74.0","79.2","82.0","89.9","49.0","52.4","56.5","59.2","64.4","68.8","72.5","82.5","49.0","55.2","57.0","61.3","68.3","70.0","76.3","77.0","82.5","90.0","49.0","53.5","57.0","60.2","66.4","70.5","73.0","80.0","86.5","53.0","55.3","57.0","63.3","67.4","70.7","74.2","77.0","81.0","86.0","50.0","50.4","54.0","58.4","64.2","68.2","71.6","73.3","76.2","78.5","52.0","56.0","59.5","62.0","69.5","74.5","78.5","81.0","84.2","90.0","52.0","57.0","62.5","63.5","71.0","74.0","78.0","80.4","82.5","89.5","50.0","55.0","59.6","63.5","70.2","73.5","77.9","82.0","83.0","90.0","55.0","59.0","61.2","64.2","68.7","73.4","80.0","85.5","85.5","94.5","51.0","55.5","59.0","65.0","69.0","72.3","76.5","82.6","88.0","51.0","59.0","60.8","65.2","72.5","75.2","80.0","82.4","85.0","92.5","53.0","58.0","60.0","64.5","71.0","76.0","80.0","82.7","86.0","92.0","55.0","58.0","62.2","65.0","72.7","77.7","87.8","94.5","52.0","56.0","58.2","61.5","68.0","71.5","74.0","77.0","81.0","88.4","50.0","55.5","59.5","62.6","68.5","71.5","76.0","79.0","81.5","88.0","54.0","58.0","61.0","64.5","71.0","73.7","78.0","82.5","84.0","89.0","48.0","50.3","53.5","56.5","61.0","66.0","70.0","74.2","75.1","83.5","52.0","58.0","60.5","64.8","69.5","75.0","75.0","84.0","86.5","95.0","53.0","56.0","57.4","60.8","67.0","72.0","77.0","78.0","84.5","87.5","51.0","55.6","59.5","62.5","70.5","73.3","76.2","83.0","87.0","91.0","49.0","52.5","53.7","57.0","63.8","68.0","71.0","76.5","78.2","84.0","53.0","57.0","60.0","62.3","69.5","73.8","80.5","84.5","87.5","91.0","  NA","52.2","57.0","57.9","65.3","70.0","76.0","79.0","81.0","86.5","47.0","55.0","57.0","62.4","67.0","70.9","75.0","51.0","54.2","55.5","59.5","66.0","72.0","78.0","80.0","82.4","87.5","51.0","55.5","56.0","59.5","65.5","69.5","75.3","78.5","81.5","86.0","50.0","55.0","58.5","61.6","66.5","70.0","75.5","79.5","83.0","89.5","51.0","55.5","56.5","60.0","65.3","69.9","75.0","79.5","82.5","86.7","45.0","53.5","55.5","60.5","69.5","74.0","77.2","82.5","84.3","44.0","51.5","55.3","62.2","68.6","74.0","80.0","81.5","89.2","52.0","54.0","58.8","61.0","65.3","70.5","74.0","77.2","82.5","88.5","51.0","54.0","56.5","59.5","66.0","70.0","74.6","78.5","80.3","86.0","52.0","56.1","57.5","63.5","67.7","71.3","74.5","79.4","83.0","87.5"],"hover_col_3":[" 0.575"," 0.888"," 0.797"," 0.661"," 0.290","-0.398"," 0.202"," 0.268","-0.332"," 0.227","-0.154","-0.380","-0.218","-0.372","-0.152","-0.251","-0.349","-0.443","-0.741"," 1.097"," 2.088"," 2.051"," 2.006"," 2.137"," 2.023"," 1.369"," 1.055"," 0.670"," 1.269"," 0.052"," 0.385"," 0.319"," 0.961"," 0.647"," 0.653"," 0.379","-0.229","-0.406","-0.185","    NA"," 1.862"," 1.475"," 0.920"," 0.706"," 1.013"," 1.782"," 2.401"," 2.307"," 2.085","-0.635","-0.045","-0.140"," 0.558","-0.064","-0.197","-0.491","-0.087"," 0.596"," 0.388","-0.154"," 0.477"," 0.746"," 0.613"," 0.824"," 0.799"," 0.445"," 0.199","-0.070"," 0.444"," 1.620"," 0.535"," 0.989"," 0.715"," 0.384"," 0.642"," 0.855"," 0.701"," 0.956"," 1.289"," 1.113"," 0.791"," 1.098"," 0.881"," 0.271"," 0.110","-0.022","-0.254"," 0.187"," 0.808"," 0.531"," 1.556"," 1.372"," 1.128"," 0.931"," 0.488"," 0.914"," 1.462"," 2.044","-0.635","-0.165"," 0.000","-0.347","-0.377","-0.848"," 0.161","-0.533","-0.049"," 0.408"," 0.575"," 0.486","-0.606","-0.246","-1.877","-1.803","-2.582","-2.648","-2.748","-1.996"," 0.575"," 1.135"," 0.313"," 0.360"," 0.877"," 0.524"," 0.855"," 0.613"," 0.596"," 0.625"," 0.052"," 1.536"," 1.950"," 0.932"," 1.055"," 0.536","-0.196"," 0.353"," 0.366"," 0.574"," 0.808"," 0.517"," 0.349"," 0.886"," 1.600"," 1.176"," 0.793"," 0.277"," 0.353"," 0.547","-2.038","-0.621","-0.287"," 0.150","-0.393","-1.184","-0.887"," 0.317","-0.233","-0.185","-3.083","-2.055","-1.629","-0.755","-0.627","-0.403"," 0.168"," 0.154"," 0.517","-0.993","-0.998","-0.603","-0.509","-0.814","-1.077","-1.124","-1.905","-0.993"," 0.589"," 0.457"," 0.623"," 0.790","-0.590"," 0.060","-0.699"," 0.103"," 0.635","-0.993","-0.161"," 0.220"," 0.198"," 0.022","-0.351","-0.836","-0.881","-0.335"," 0.808"," 0.281","-0.021"," 0.829","-0.262","-0.994","-0.866","-0.702","-0.946","-0.905","-0.470","-1.425","-1.266","-0.955","-1.196","-1.102","-1.281","-2.119","-2.235","-2.878"," 0.327"," 0.131"," 0.645"," 0.478"," 0.698"," 0.777"," 0.568"," 0.409"," 0.309"," 0.368"," 0.327"," 1.166"," 2.532"," 0.711"," 1.224"," 0.532"," 0.243"," 0.164","-0.137"," 0.322","-0.635"," 0.459"," 0.739"," 0.873"," 0.065","-0.019"," 0.265"," 0.514","-0.121"," 0.090"," 1.771"," 1.494"," 1.058"," 0.858"," 0.377"," 0.357"," 0.907"," 1.800"," 0.819"," 1.379"," 0.052"," 0.640"," 0.994"," 1.146"," 0.786"," 0.380"," 0.330"," 0.117"," 0.107","-0.154"," 1.549"," 0.929"," 1.318"," 1.582"," 0.935"," 1.024"," 0.824"," 0.746"," 0.961"," 1.097"," 2.185"," 1.760"," 2.278"," 1.797"," 2.003"," 1.772"," 1.434"," 1.359"," 1.291"," 1.771"," 1.412"," 1.833"," 1.470"," 1.637"," 1.999"," 1.758"," 1.626"," 0.327"," 0.548"," 0.463","-0.136","-0.045","-0.473","-0.952","-1.055","-0.683","-0.176","-0.470"," 0.739"," 1.000"," 1.058"," 0.800"," 0.093"," 0.285"," 0.121","-0.243"," 0.065"," 1.289"," 1.464"," 1.709"," 1.135"," 0.827"," 0.364"," 0.503"," 0.687"," 0.318","-0.041","-1.515","-1.854","-2.146","-1.597","-2.427","-2.143","-2.021","-1.768","-2.316","-1.416"," 0.327"," 1.359"," 1.036"," 1.467"," 0.344"," 0.823","-0.517"," 0.671"," 1.140"," 1.557"," 0.808"," 0.548"," 0.107","-0.275","-0.444","-0.283"," 0.139","-0.707"," 0.198","-0.566"," 0.052"," 0.888"," 1.423"," 0.971"," 1.531"," 0.864"," 0.394"," 1.232"," 1.375"," 1.020","-0.993","-0.901","-1.278","-1.204","-1.126","-1.257","-1.574","-0.882","-1.548","-1.304"," 0.808"," 0.847"," 0.579","-0.016"," 0.723"," 0.473"," 1.264"," 1.428"," 1.384"," 0.736","    NA","-0.520","-0.322","-0.500","-0.185","-0.367"," 0.301","-0.136","-0.467","-0.282","-2.038","-0.042"," 0.082"," 0.156"," 0.054","-0.225"," 0.064"," 0.052"," 0.436","-0.456","-0.209","-0.276"," 0.167"," 0.708"," 0.395","-0.004","-0.093"," 0.052"," 0.640","-0.441","-0.292","-0.366","-0.627"," 0.098","-0.088","-0.107","-0.526","-0.635","-0.272"," 0.061"," 0.065","-0.644","-1.044","-0.406","-0.185","-0.163"," 0.103"," 0.052"," 0.592","-0.065"," 0.063","-0.372","-0.276","-0.083"," 0.226"," 0.179","-0.228","-3.041","-0.804","-1.069","-0.403"," 0.459"," 0.478"," 0.012"," 0.518"," 0.512","-3.605","-3.009","-2.604","-1.504","-1.049","-0.223"," 0.239","-0.223"," 0.521"," 0.575"," 0.236"," 0.898"," 0.401","-0.453","-0.846","-0.516","-0.473"," 0.082"," 0.265"," 0.052","-0.203","-0.293","-0.371","-0.702","-0.714","-0.318","-0.203","-0.477","-0.542"," 0.575"," 0.840"," 0.507"," 1.769"," 0.720"," 0.202","-0.356"," 0.215"," 0.018","-0.076"]}}},{"type":"Circle","id":"73096853788e4c1b6e56a2b5d1aa8b8b","attributes":{"id":"73096853788e4c1b6e56a2b5d1aa8b8b","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"95367e90bb8c78ad17b9a8615c1eeea8","attributes":{"id":"95367e90bb8c78ad17b9a8615c1eeea8","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"3ffda63bc2f50a18c04303ea640f5b01","attributes":{"id":"3ffda63bc2f50a18c04303ea640f5b01","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"f1d854522edf5c04c166e90c3df387b5","attributes":{"id":"f1d854522edf5c04c166e90c3df387b5","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Circle","id":"95367e90bb8c78ad17b9a8615c1eeea8"},"hover_glyph":{"type":"Circle","id":"3ffda63bc2f50a18c04303ea640f5b01"},"name":null,"data_source":{"type":"ColumnDataSource","id":"555f1d4bb875d4f3d22848c951d06467"},"glyph":{"type":"Circle","id":"73096853788e4c1b6e56a2b5d1aa8b8b"}}},{"type":"Range1d","id":"d7d196b07b2a22b10cb73bd0bbf37993","attributes":{"id":"d7d196b07b2a22b10cb73bd0bbf37993","tags":[],"start":-0.1,"end":2.3}},{"type":"Range1d","id":"1c664e0e95a75b9efc55cfdedc43894a","attributes":{"id":"1c664e0e95a75b9efc55cfdedc43894a","tags":[],"start":40.36,"end":99.64}},{"type":"LinearAxis","id":"e9d350ea094f4c0e01f87920ae371c35","attributes":{"id":"e9d350ea094f4c0e01f87920ae371c35","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"axis_label":"Age (year)","formatter":{"type":"BasicTickFormatter","id":"15ec82b60166d603ddc9343607ff6314"},"ticker":{"type":"BasicTicker","id":"1fef11f05d0957a18124f95db657d4a2"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"15ec82b60166d603ddc9343607ff6314","attributes":{"id":"15ec82b60166d603ddc9343607ff6314","tags":[]}},{"type":"BasicTicker","id":"1fef11f05d0957a18124f95db657d4a2","attributes":{"id":"1fef11f05d0957a18124f95db657d4a2","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"300657c830aa3fd3bf21f416d2f46ef2","attributes":{"id":"300657c830aa3fd3bf21f416d2f46ef2","tags":[],"dimension":0,"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"1fef11f05d0957a18124f95db657d4a2"}}},{"type":"LinearAxis","id":"7966aabbf8de1afde6f2c1ee8e90cb51","attributes":{"id":"7966aabbf8de1afde6f2c1ee8e90cb51","tags":[],"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"axis_label":"Height (cm)","formatter":{"type":"BasicTickFormatter","id":"3b7fb83d30af151225a552ebe99a5264"},"ticker":{"type":"BasicTicker","id":"caa5b62dd127fa16999a6680ebfad4a3"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"3b7fb83d30af151225a552ebe99a5264","attributes":{"id":"3b7fb83d30af151225a552ebe99a5264","tags":[]}},{"type":"BasicTicker","id":"caa5b62dd127fa16999a6680ebfad4a3","attributes":{"id":"caa5b62dd127fa16999a6680ebfad4a3","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"5cc00492c1dee29b8807cce1d6e02195","attributes":{"id":"5cc00492c1dee29b8807cce1d6e02195","tags":[],"dimension":1,"plot":{"type":"Plot","id":"6598b4f4cd4062ae3af50ce65100ad87","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"caa5b62dd127fa16999a6680ebfad4a3"}}}]}}},"debug":false},"evals":[],"jsHooks":[]}</script><p class="caption">
Height (cm) by age (years) for 50 children of SMOCC.
</p>
</div>
<p>The scatterplot of height against age clearly reveals the expected rising pattern of height. Also obvious will be the pattern of scheduled visits. Apart from birth, there is some variability in the timing of the visit, and this variability increases with age.</p>
<div class="figure">
<div id="htmlwidget-47f79e9d4b5c2f9c7c09" style="width:700px;height:432.632880098888px;" class="rbokeh html-widget"></div>
<script type="application/json" data-for="htmlwidget-47f79e9d4b5c2f9c7c09">{"x":{"elementid":"c7347a534443e1d8a6a6f510303cb69d","modeltype":"Plot","modelid":"8870e277bae794382c6eae0e0c2064dd","docid":"588aeb900eaf237306fa6191af22c27a","docs_json":{"588aeb900eaf237306fa6191af22c27a":{"version":"0.12.5","title":"Bokeh Figure","roots":{"root_ids":["8870e277bae794382c6eae0e0c2064dd"],"references":[{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","attributes":{"id":"8870e277bae794382c6eae0e0c2064dd","sizing_mode":"scale_both","x_range":{"type":"Range1d","id":"df6121307bb445f1eb3206f37059c539"},"y_range":{"type":"Range1d","id":"46ac767ed90ac800358fd801853953a1"},"left":[{"type":"LinearAxis","id":"78cc0248c8f8e4d25c2888d17e042160"}],"below":[{"type":"LinearAxis","id":"c1acbfe1111cd816d3e1db352aeac3a5"}],"right":[],"above":[],"renderers":[{"type":"BoxAnnotation","id":"0c99b160577489d71c9d66676aa05c90"},{"type":"GlyphRenderer","id":"5cc7b211d5c71047787c0eba603a121d"},{"type":"GlyphRenderer","id":"23c2542ee30c3a31a447a45d16cbd0da"},{"type":"GlyphRenderer","id":"bde461a0678c62baf8fcb84bdf8f1d09"},{"type":"GlyphRenderer","id":"57a03667fc356382d898f3f9e2a7e1ad"},{"type":"GlyphRenderer","id":"440e3dc8a936024c1f801159503d4f34"},{"type":"GlyphRenderer","id":"2a022abe6c8a4e962057188a8f1ae300"},{"type":"LinearAxis","id":"c1acbfe1111cd816d3e1db352aeac3a5"},{"type":"Grid","id":"6d6d531c4d888958afa82026a4a5ebb2"},{"type":"LinearAxis","id":"78cc0248c8f8e4d25c2888d17e042160"},{"type":"Grid","id":"13ac309301d1ecf463009b8bba1177e6"}],"extra_y_ranges":{},"extra_x_ranges":{},"tags":[],"min_border_left":4,"min_border_right":4,"min_border_top":4,"min_border_bottom":4,"lod_threshold":null,"toolbar":{"type":"Toolbar","id":"68afa96e583286f1dee613ba58030489"},"tool_events":{"type":"ToolEvents","id":"245a25554d53d2120da769e4138a7ed0"}},"subtype":"Figure"},{"type":"Toolbar","id":"68afa96e583286f1dee613ba58030489","attributes":{"id":"68afa96e583286f1dee613ba58030489","tags":[],"active_drag":"auto","active_scroll":"auto","active_tap":"auto","tools":[{"type":"PanTool","id":"e5b065bb9d5905c40bb5b994c9785b71"},{"type":"WheelZoomTool","id":"79d1ab8b7a560f1160f7f6acf9a0f6ca"},{"type":"BoxZoomTool","id":"324dace4b11762ecd808dda9e82e251d"},{"type":"ResetTool","id":"5375a77fe3de8282956e7c194f09c6ee"},{"type":"SaveTool","id":"688614a31ca9e0062a8a213a0be9612b"},{"type":"HelpTool","id":"a80eaa2edc24eb88eb5be82fb2da6b74"},{"type":"HoverTool","id":"f8b2dc571473b795ee7ea1b35959d961"}],"logo":null}},{"type":"PanTool","id":"e5b065bb9d5905c40bb5b994c9785b71","attributes":{"id":"e5b065bb9d5905c40bb5b994c9785b71","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"dimensions":"both"}},{"type":"ToolEvents","id":"245a25554d53d2120da769e4138a7ed0","attributes":{"id":"245a25554d53d2120da769e4138a7ed0","tags":[]},"geometries":[]},{"type":"WheelZoomTool","id":"79d1ab8b7a560f1160f7f6acf9a0f6ca","attributes":{"id":"79d1ab8b7a560f1160f7f6acf9a0f6ca","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"dimensions":"both"}},{"type":"BoxAnnotation","id":"0c99b160577489d71c9d66676aa05c90","attributes":{"id":"0c99b160577489d71c9d66676aa05c90","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"fill_color":{"units":"data","value":"lightgrey"},"fill_alpha":{"units":"data","value":0.5},"line_dash":[4,4],"line_width":{"units":"data","value":2},"level":"overlay","top_units":"screen","bottom_units":"screen","left_units":"screen","right_units":"screen","render_mode":"css"}},{"type":"BoxZoomTool","id":"324dace4b11762ecd808dda9e82e251d","attributes":{"id":"324dace4b11762ecd808dda9e82e251d","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"overlay":{"type":"BoxAnnotation","id":"0c99b160577489d71c9d66676aa05c90"}}},{"type":"ResetTool","id":"5375a77fe3de8282956e7c194f09c6ee","attributes":{"id":"5375a77fe3de8282956e7c194f09c6ee","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"}}},{"type":"SaveTool","id":"688614a31ca9e0062a8a213a0be9612b","attributes":{"id":"688614a31ca9e0062a8a213a0be9612b","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"}}},{"type":"HelpTool","id":"a80eaa2edc24eb88eb5be82fb2da6b74","attributes":{"id":"a80eaa2edc24eb88eb5be82fb2da6b74","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"redirect":"http://hafen.github.io/rbokeh","help_tooltip":"Click to learn more about rbokeh."}},{"type":"ColumnDataSource","id":"4943dcc9e8ec0ca4ea7cc7f6c5527bd5","attributes":{"id":"4943dcc9e8ec0ca4ea7cc7f6c5527bd5","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-2.5,-2.5,2.5,2.5]]}}},{"type":"Patches","id":"1ccd82962ca9ff01ef441f49337d243f","attributes":{"id":"1ccd82962ca9ff01ef441f49337d243f","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"2cf442ebff5a091c83cdc8ff97899611","attributes":{"id":"2cf442ebff5a091c83cdc8ff97899611","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"8348fae3fc52ddecd829698d86474af2","attributes":{"id":"8348fae3fc52ddecd829698d86474af2","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"5cc7b211d5c71047787c0eba603a121d","attributes":{"id":"5cc7b211d5c71047787c0eba603a121d","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"2cf442ebff5a091c83cdc8ff97899611"},"hover_glyph":{"type":"Patches","id":"8348fae3fc52ddecd829698d86474af2"},"name":null,"data_source":{"type":"ColumnDataSource","id":"4943dcc9e8ec0ca4ea7cc7f6c5527bd5"},"glyph":{"type":"Patches","id":"1ccd82962ca9ff01ef441f49337d243f"}}},{"type":"ColumnDataSource","id":"faffe3e5d28b28baa9b98707732e1073","attributes":{"id":"faffe3e5d28b28baa9b98707732e1073","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-2,-2,2,2]]}}},{"type":"Patches","id":"e45358ed577b2d5ef7f71952d77a714e","attributes":{"id":"e45358ed577b2d5ef7f71952d77a714e","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"af1ba2cbd9f3264419a61e2c066821ea","attributes":{"id":"af1ba2cbd9f3264419a61e2c066821ea","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"0b431486188f8291db3134d60606d9de","attributes":{"id":"0b431486188f8291db3134d60606d9de","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"23c2542ee30c3a31a447a45d16cbd0da","attributes":{"id":"23c2542ee30c3a31a447a45d16cbd0da","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"af1ba2cbd9f3264419a61e2c066821ea"},"hover_glyph":{"type":"Patches","id":"0b431486188f8291db3134d60606d9de"},"name":null,"data_source":{"type":"ColumnDataSource","id":"faffe3e5d28b28baa9b98707732e1073"},"glyph":{"type":"Patches","id":"e45358ed577b2d5ef7f71952d77a714e"}}},{"type":"ColumnDataSource","id":"d905cb790b5008193349c3b7d34d58fa","attributes":{"id":"d905cb790b5008193349c3b7d34d58fa","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-1,-1,1,1]]}}},{"type":"Patches","id":"103fa86e8429893662630dffb4adec98","attributes":{"id":"103fa86e8429893662630dffb4adec98","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"455efc469a89a3c130f15d1256a0c09d","attributes":{"id":"455efc469a89a3c130f15d1256a0c09d","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"5943b5e3f0a3553131baa75ba6e55c06","attributes":{"id":"5943b5e3f0a3553131baa75ba6e55c06","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"bde461a0678c62baf8fcb84bdf8f1d09","attributes":{"id":"bde461a0678c62baf8fcb84bdf8f1d09","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"455efc469a89a3c130f15d1256a0c09d"},"hover_glyph":{"type":"Patches","id":"5943b5e3f0a3553131baa75ba6e55c06"},"name":null,"data_source":{"type":"ColumnDataSource","id":"d905cb790b5008193349c3b7d34d58fa"},"glyph":{"type":"Patches","id":"103fa86e8429893662630dffb4adec98"}}},{"type":"ColumnDataSource","id":"29bfff4ce8e8e3b2d1d027ebd08b755c","attributes":{"id":"29bfff4ce8e8e3b2d1d027ebd08b755c","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-0,-0,0,0]]}}},{"type":"Patches","id":"789154559ca33b50616a03e57fd21e39","attributes":{"id":"789154559ca33b50616a03e57fd21e39","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"fa74f47526763224d665ef15b1182b3d","attributes":{"id":"fa74f47526763224d665ef15b1182b3d","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"1690d107ba1c71253cf4a1a9616fcec9","attributes":{"id":"1690d107ba1c71253cf4a1a9616fcec9","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"57a03667fc356382d898f3f9e2a7e1ad","attributes":{"id":"57a03667fc356382d898f3f9e2a7e1ad","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"fa74f47526763224d665ef15b1182b3d"},"hover_glyph":{"type":"Patches","id":"1690d107ba1c71253cf4a1a9616fcec9"},"name":null,"data_source":{"type":"ColumnDataSource","id":"29bfff4ce8e8e3b2d1d027ebd08b755c"},"glyph":{"type":"Patches","id":"789154559ca33b50616a03e57fd21e39"}}},{"type":"ColumnDataSource","id":"0471cd65eaa9e2ddecdd3482cb9ef5a2","attributes":{"id":"0471cd65eaa9e2ddecdd3482cb9ef5a2","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,2.2],"y":[0,0]}}},{"type":"Line","id":"2a14233c35a7792e6d4c9a6ac590cb50","attributes":{"id":"2a14233c35a7792e6d4c9a6ac590cb50","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"e2d2b69cbaa88d36963d5743c927bb9a","attributes":{"id":"e2d2b69cbaa88d36963d5743c927bb9a","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"fa8fe944336401a448f0c9c9f6475cd1","attributes":{"id":"fa8fe944336401a448f0c9c9f6475cd1","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"440e3dc8a936024c1f801159503d4f34","attributes":{"id":"440e3dc8a936024c1f801159503d4f34","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Line","id":"e2d2b69cbaa88d36963d5743c927bb9a"},"hover_glyph":{"type":"Line","id":"fa8fe944336401a448f0c9c9f6475cd1"},"name":null,"data_source":{"type":"ColumnDataSource","id":"0471cd65eaa9e2ddecdd3482cb9ef5a2"},"glyph":{"type":"Line","id":"2a14233c35a7792e6d4c9a6ac590cb50"}}},{"type":"HoverTool","id":"f8b2dc571473b795ee7ea1b35959d961","attributes":{"id":"f8b2dc571473b795ee7ea1b35959d961","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"renderers":[{"type":"GlyphRenderer","id":"2a022abe6c8a4e962057188a8f1ae300"}],"names":[],"anchor":"center","attachment":"horizontal","line_policy":"prev","mode":"mouse","point_policy":"snap_to_data","tooltips":[["data$subjid","@hover_col_1"],["data$hgt","@hover_col_2"]]}},{"type":"ColumnDataSource","id":"ee1e75dda7e8de30e241d54fe1d5ffe4","attributes":{"id":"ee1e75dda7e8de30e241d54fe1d5ffe4","tags":[],"column_names":["x","y","hover_col_1","hover_col_2"],"selected":[],"data":{"x":[0,0.0821,0.1588,0.2546,0.5038,0.7529,1.0021,1.1745,1.5661,2.0096,0,0.1123,0.1506,0.2464,0.4956,0.7447,0.9938,1.5195,1.9603,0,0.0739,0.1506,0.2847,0.4956,0.7447,0.9938,1.1663,1.5195,2.0014,0,0.0657,0.1615,0.2382,0.5257,0.7365,0.9856,1.2731,1.5113,2.0096,0,0.0903,0.1478,0.2628,0.512,0.7611,1.0103,1.2019,1.4976,2.0342,0,0.063,0.1588,0.2355,0.5229,0.7721,1.0212,1.1937,1.5086,1.9904,0,0.0767,0.1342,0.2491,0.4983,0.7474,1.0157,1.2457,1.4839,2.0205,0,0.0767,0.1533,0.23,0.4983,0.7091,0.9774,1.4949,2.0972,0,0.0794,0.1561,0.271,0.501,0.7885,1.0103,1.2485,1.6016,2.0041,0,0.0739,0.1506,0.2272,0.4956,0.7447,1.1472,1.2047,1.5003,1.9603,0,0.0767,0.1916,0.2683,0.5366,0.7858,1.0075,1.2457,1.5031,1.9849,0,0.0739,0.1506,0.2656,0.4956,0.7064,1.0048,1.243,1.5387,2.0945,0,0.0767,0.1533,0.3066,0.4791,0.7666,0.9774,1.2266,1.744,2.0041,0,0.0849,0.1807,0.2765,0.4873,0.8433,1.024,1.2348,1.4538,2.0698,0,0.0794,0.1561,0.271,0.501,0.731,1.0185,1.191,1.4867,1.9466,0,0.0657,0.1807,0.2765,0.4983,0.7365,1.024,1.2731,1.5113,2.0096,0,0.1506,0.2464,0.5147,0.7447,0.9938,1.243,1.462,2.078,0,0.0986,0.1944,0.271,0.4928,0.7693,1.0185,2.1191,0,0.0876,0.1451,0.2601,0.501,0.7693,1.065,1.2567,1.514,2.0507,0,0.0821,0.1588,0.2546,0.4956,0.7639,1.0021,1.5469,2.0068,0,0.0821,0.1396,0.2546,0.5038,0.7912,1.0021,1.1745,1.5661,2.0096,0,0.0657,0.1615,0.2765,0.5257,0.7365,0.9856,1.2731,1.5606,2.0096,0,0.1068,0.1643,0.2409,0.4901,0.7392,1.0267,1.2375,1.514,1.9959,0,0.0767,0.1342,0.2683,0.4983,0.7474,1.0541,1.2457,1.4839,1.9658,0,0.0657,0.1615,0.2574,0.6023,0.8049,1.0431,1.2923,1.5222,2.0862,0,0.1068,0.1834,0.2793,0.4901,0.7392,1.065,1.2758,1.4949,2.1109,0,0.0931,0.1697,0.3422,0.5339,0.7639,1.0322,1.5195,2.0178,0,0.104,0.1807,0.2765,0.5257,0.7556,1.0431,1.2539,1.473,2.0507,0,0.0767,0.1533,0.2491,0.5175,0.7474,1.0157,1.2457,1.5031,2.0424,0,0.0876,0.1643,0.2601,0.5284,0.7392,1.4565,2.0342,0,0.0849,0.1424,0.2683,0.5065,0.7556,1.0048,1.2539,1.4949,2.0123,0,0.0876,0.1834,0.271,0.5092,0.7584,1.0075,1.2375,1.514,2.0315,0,0.0849,0.1424,0.2683,0.5448,0.7556,1.0048,1.2923,1.4949,2.0287,0,0.0876,0.2026,0.2601,0.5092,0.7584,1.0075,1.2676,1.4757,2.0534,0,0.0903,0.167,0.2546,0.5311,0.7611,0.9911,1.4127,1.4976,2.1027,0,0.0849,0.1424,0.2574,0.5065,0.7556,1.0048,1.2539,1.5688,2.0507,0,0.0821,0.1588,0.2738,0.5229,0.7529,1.0021,1.3087,1.5852,2.0287,0,0.0958,0.1533,0.2491,0.4983,0.7474,0.9966,1.2567,1.5606,2.0698,0,0.0931,0.1807,0.2847,0.4873,0.7447,1.0322,1.2813,1.5195,1.9795,0,0.0657,0.1916,0.23,0.4682,0.7365,1.0048,1.2923,1.5277,1.9904,0,0.1177,0.167,0.3285,0.5202,0.7693,0.9802,0,0.0684,0.1561,0.2601,0.5092,0.7775,1.065,1.2567,1.5332,2.0315,0,0.0931,0.1697,0.2656,0.4956,0.7447,0.9938,1.243,1.4812,2.0178,0,0.104,0.1725,0.2574,0.5065,0.7556,1.0048,1.2539,1.5332,2.0315,0,0.0958,0.1615,0.2574,0.4873,0.7173,1.0048,1.2539,1.4949,1.9932,0,0.0958,0.1615,0.2574,0.5175,0.7556,1.0431,1.3306,1.473,0,0.1971,0.293,0.4654,0.7529,0.9637,1.2895,1.5086,2.0068,0,0.0739,0.1697,0.2656,0.4956,0.8405,1.013,1.2238,1.5195,2.0178,0,0.0986,0.1752,0.271,0.5585,0.7885,1.0185,1.2676,1.4702,2.0233,0,0.0986,0.1561,0.2519,0.4819,0.731,1.0185,1.2485,1.5825,2.026],"y":[0.575,0.888,0.797,0.661,0.29,-0.398,0.202,0.268,-0.332,0.227,-0.154,-0.38,-0.218,-0.372,-0.152,-0.251,-0.349,-0.443,-0.741,1.097,2.088,2.051,2.006,2.137,2.023,1.369,1.055,0.67,1.269,0.052,0.385,0.319,0.961,0.647,0.653,0.379,-0.229,-0.406,-0.185,null,1.862,1.475,0.92,0.706,1.013,1.782,2.401,2.307,2.085,-0.635,-0.045,-0.14,0.558,-0.064,-0.197,-0.491,-0.087,0.596,0.388,-0.154,0.477,0.746,0.613,0.824,0.799,0.445,0.199,-0.07,0.444,1.62,0.535,0.989,0.715,0.384,0.642,0.855,0.701,0.956,1.289,1.113,0.791,1.098,0.881,0.271,0.11,-0.022,-0.254,0.187,0.808,0.531,1.556,1.372,1.128,0.931,0.488,0.914,1.462,2.044,-0.635,-0.165,0,-0.347,-0.377,-0.848,0.161,-0.533,-0.049,0.408,0.575,0.486,-0.606,-0.246,-1.877,-1.803,-2.582,-2.648,-2.748,-1.996,0.575,1.135,0.313,0.36,0.877,0.524,0.855,0.613,0.596,0.625,0.052,1.536,1.95,0.932,1.055,0.536,-0.196,0.353,0.366,0.574,0.808,0.517,0.349,0.886,1.6,1.176,0.793,0.277,0.353,0.547,-2.038,-0.621,-0.287,0.15,-0.393,-1.184,-0.887,0.317,-0.233,-0.185,-3.083,-2.055,-1.629,-0.755,-0.627,-0.403,0.168,0.154,0.517,-0.993,-0.998,-0.603,-0.509,-0.814,-1.077,-1.124,-1.905,-0.993,0.589,0.457,0.623,0.79,-0.59,0.06,-0.699,0.103,0.635,-0.993,-0.161,0.22,0.198,0.022,-0.351,-0.836,-0.881,-0.335,0.808,0.281,-0.021,0.829,-0.262,-0.994,-0.866,-0.702,-0.946,-0.905,-0.47,-1.425,-1.266,-0.955,-1.196,-1.102,-1.281,-2.119,-2.235,-2.878,0.327,0.131,0.645,0.478,0.698,0.777,0.568,0.409,0.309,0.368,0.327,1.166,2.532,0.711,1.224,0.532,0.243,0.164,-0.137,0.322,-0.635,0.459,0.739,0.873,0.065,-0.019,0.265,0.514,-0.121,0.09,1.771,1.494,1.058,0.858,0.377,0.357,0.907,1.8,0.819,1.379,0.052,0.64,0.994,1.146,0.786,0.38,0.33,0.117,0.107,-0.154,1.549,0.929,1.318,1.582,0.935,1.024,0.824,0.746,0.961,1.097,2.185,1.76,2.278,1.797,2.003,1.772,1.434,1.359,1.291,1.771,1.412,1.833,1.47,1.637,1.999,1.758,1.626,0.327,0.548,0.463,-0.136,-0.045,-0.473,-0.952,-1.055,-0.683,-0.176,-0.47,0.739,1,1.058,0.8,0.093,0.285,0.121,-0.243,0.065,1.289,1.464,1.709,1.135,0.827,0.364,0.503,0.687,0.318,-0.041,-1.515,-1.854,-2.146,-1.597,-2.427,-2.143,-2.021,-1.768,-2.316,-1.416,0.327,1.359,1.036,1.467,0.344,0.823,-0.517,0.671,1.14,1.557,0.808,0.548,0.107,-0.275,-0.444,-0.283,0.139,-0.707,0.198,-0.566,0.052,0.888,1.423,0.971,1.531,0.864,0.394,1.232,1.375,1.02,-0.993,-0.901,-1.278,-1.204,-1.126,-1.257,-1.574,-0.882,-1.548,-1.304,0.808,0.847,0.579,-0.016,0.723,0.473,1.264,1.428,1.384,0.736,null,-0.52,-0.322,-0.5,-0.185,-0.367,0.301,-0.136,-0.467,-0.282,-2.038,-0.042,0.082,0.156,0.054,-0.225,0.064,0.052,0.436,-0.456,-0.209,-0.276,0.167,0.708,0.395,-0.004,-0.093,0.052,0.64,-0.441,-0.292,-0.366,-0.627,0.098,-0.088,-0.107,-0.526,-0.635,-0.272,0.061,0.065,-0.644,-1.044,-0.406,-0.185,-0.163,0.103,0.052,0.592,-0.065,0.063,-0.372,-0.276,-0.083,0.226,0.179,-0.228,-3.041,-0.804,-1.069,-0.403,0.459,0.478,0.012,0.518,0.512,-3.605,-3.009,-2.604,-1.504,-1.049,-0.223,0.239,-0.223,0.521,0.575,0.236,0.898,0.401,-0.453,-0.846,-0.516,-0.473,0.082,0.265,0.052,-0.203,-0.293,-0.371,-0.702,-0.714,-0.318,-0.203,-0.477,-0.542,0.575,0.84,0.507,1.769,0.72,0.202,-0.356,0.215,0.018,-0.076],"hover_col_1":["10001","10001","10001","10001","10001","10001","10001","10001","10001","10001","10002","10002","10002","10002","10002","10002","10002","10002","10002","10003","10003","10003","10003","10003","10003","10003","10003","10003","10003","10004","10004","10004","10004","10004","10004","10004","10004","10004","10004","10005","10005","10005","10005","10005","10005","10005","10005","10005","10005","10006","10006","10006","10006","10006","10006","10006","10006","10006","10006","10007","10007","10007","10007","10007","10007","10007","10007","10007","10007","10008","10008","10008","10008","10008","10008","10008","10008","10008","10009","10009","10009","10009","10009","10009","10009","10009","10009","10009","10012","10012","10012","10012","10012","10012","10012","10012","10012","10012","10013","10013","10013","10013","10013","10013","10013","10013","10013","10013","10014","10014","10014","10014","10014","10014","10014","10014","10014","10014","10015","10015","10015","10015","10015","10015","10015","10015","10015","10015","10017","10017","10017","10017","10017","10017","10017","10017","10017","10017","10018","10018","10018","10018","10018","10018","10018","10018","10018","10018","10022","10022","10022","10022","10022","10022","10022","10022","10022","10022","10023","10023","10023","10023","10023","10023","10023","10023","10023","10024","10024","10024","10024","10024","10024","10024","10024","10025","10025","10025","10025","10025","10025","10025","10025","10025","10025","10026","10026","10026","10026","10026","10026","10026","10026","10026","10028","10028","10028","10028","10028","10028","10028","10028","10028","10028","10029","10029","10029","10029","10029","10029","10029","10029","10029","10029","10030","10030","10030","10030","10030","10030","10030","10030","10030","10030","10031","10031","10031","10031","10031","10031","10031","10031","10031","10031","10032","10032","10032","10032","10032","10032","10032","10032","10032","10032","10034","10034","10034","10034","10034","10034","10034","10034","10034","10034","10035","10035","10035","10035","10035","10035","10035","10035","10035","10036","10036","10036","10036","10036","10036","10036","10036","10036","10036","10037","10037","10037","10037","10037","10037","10037","10037","10037","10037","10038","10038","10038","10038","10038","10038","10038","10038","10039","10039","10039","10039","10039","10039","10039","10039","10039","10039","10040","10040","10040","10040","10040","10040","10040","10040","10040","10040","10041","10041","10041","10041","10041","10041","10041","10041","10041","10041","10043","10043","10043","10043","10043","10043","10043","10043","10043","10043","10044","10044","10044","10044","10044","10044","10044","10044","10044","10044","10045","10045","10045","10045","10045","10045","10045","10045","10045","10045","10046","10046","10046","10046","10046","10046","10046","10046","10046","10046","10048","10048","10048","10048","10048","10048","10048","10048","10048","10048","10049","10049","10049","10049","10049","10049","10049","10049","10049","10049","10050","10050","10050","10050","10050","10050","10050","10050","10050","10050","10051","10051","10051","10051","10051","10051","10051","10052","10052","10052","10052","10052","10052","10052","10052","10052","10052","10053","10053","10053","10053","10053","10053","10053","10053","10053","10053","10054","10054","10054","10054","10054","10054","10054","10054","10054","10054","10057","10057","10057","10057","10057","10057","10057","10057","10057","10057","10058","10058","10058","10058","10058","10058","10058","10058","10058","10059","10059","10059","10059","10059","10059","10059","10059","10059","10060","10060","10060","10060","10060","10060","10060","10060","10060","10060","10061","10061","10061","10061","10061","10061","10061","10061","10061","10061","10062","10062","10062","10062","10062","10062","10062","10062","10062","10062"],"hover_col_2":["52.0","55.6","58.2","61.2","67.2","70.2","75.7","78.5","81.8","88.3","51.0","55.1","57.0","60.2","67.5","71.9","75.5","82.0","86.0","53.0","57.7","60.5","65.1","71.3","76.0","78.6","80.5","84.2","91.5","51.0","54.0","57.3","61.3","68.5","72.5","75.9","78.5","81.0","87.0","  NA","59.1","60.7","63.8","70.0","75.5","81.6","86.2","90.0","96.0","50.0","53.8","57.5","62.0","68.3","72.5","75.5","79.0","85.0","90.0","51.0","55.5","58.5","62.6","70.0","74.7","78.0","80.5","82.7","90.5","54.0","54.7","58.4","60.5","67.3","72.0","77.0","84.0","91.5","54.0","57.0","59.5","64.5","70.2","74.0","77.0","79.9","83.5","89.5","53.0","55.5","61.0","63.6","70.7","75.0","80.0","82.0","87.5","95.0","50.0","54.1","59.1","61.0","67.8","71.0","77.1","78.4","83.0","90.0","52.0","54.5","55.0","59.6","62.0","66.0","68.5","71.5","74.5","82.0","52.0","55.9","57.0","62.2","68.0","72.7","77.0","80.2","86.5","89.5","51.0","57.0","61.4","62.5","68.6","74.0","75.0","79.6","82.5","90.0","53.0","55.7","58.5","64.0","72.0","75.4","79.0","80.0","84.0","90.0","47.0","52.0","56.7","60.8","65.5","68.0","73.2","80.0","81.5","87.0","45.0","52.0","56.0","65.0","69.5","74.0","79.2","82.0","89.9","49.0","52.4","56.5","59.2","64.4","68.8","72.5","82.5","49.0","55.2","57.0","61.3","68.3","70.0","76.3","77.0","82.5","90.0","49.0","53.5","57.0","60.2","66.4","70.5","73.0","80.0","86.5","53.0","55.3","57.0","63.3","67.4","70.7","74.2","77.0","81.0","86.0","50.0","50.4","54.0","58.4","64.2","68.2","71.6","73.3","76.2","78.5","52.0","56.0","59.5","62.0","69.5","74.5","78.5","81.0","84.2","90.0","52.0","57.0","62.5","63.5","71.0","74.0","78.0","80.4","82.5","89.5","50.0","55.0","59.6","63.5","70.2","73.5","77.9","82.0","83.0","90.0","55.0","59.0","61.2","64.2","68.7","73.4","80.0","85.5","85.5","94.5","51.0","55.5","59.0","65.0","69.0","72.3","76.5","82.6","88.0","51.0","59.0","60.8","65.2","72.5","75.2","80.0","82.4","85.0","92.5","53.0","58.0","60.0","64.5","71.0","76.0","80.0","82.7","86.0","92.0","55.0","58.0","62.2","65.0","72.7","77.7","87.8","94.5","52.0","56.0","58.2","61.5","68.0","71.5","74.0","77.0","81.0","88.4","50.0","55.5","59.5","62.6","68.5","71.5","76.0","79.0","81.5","88.0","54.0","58.0","61.0","64.5","71.0","73.7","78.0","82.5","84.0","89.0","48.0","50.3","53.5","56.5","61.0","66.0","70.0","74.2","75.1","83.5","52.0","58.0","60.5","64.8","69.5","75.0","75.0","84.0","86.5","95.0","53.0","56.0","57.4","60.8","67.0","72.0","77.0","78.0","84.5","87.5","51.0","55.6","59.5","62.5","70.5","73.3","76.2","83.0","87.0","91.0","49.0","52.5","53.7","57.0","63.8","68.0","71.0","76.5","78.2","84.0","53.0","57.0","60.0","62.3","69.5","73.8","80.5","84.5","87.5","91.0","  NA","52.2","57.0","57.9","65.3","70.0","76.0","79.0","81.0","86.5","47.0","55.0","57.0","62.4","67.0","70.9","75.0","51.0","54.2","55.5","59.5","66.0","72.0","78.0","80.0","82.4","87.5","51.0","55.5","56.0","59.5","65.5","69.5","75.3","78.5","81.5","86.0","50.0","55.0","58.5","61.6","66.5","70.0","75.5","79.5","83.0","89.5","51.0","55.5","56.5","60.0","65.3","69.9","75.0","79.5","82.5","86.7","45.0","53.5","55.5","60.5","69.5","74.0","77.2","82.5","84.3","44.0","51.5","55.3","62.2","68.6","74.0","80.0","81.5","89.2","52.0","54.0","58.8","61.0","65.3","70.5","74.0","77.2","82.5","88.5","51.0","54.0","56.5","59.5","66.0","70.0","74.6","78.5","80.3","86.0","52.0","56.1","57.5","63.5","67.7","71.3","74.5","79.4","83.0","87.5"]}}},{"type":"Circle","id":"d47c7da77fdcff6d70df2e2eda85786f","attributes":{"id":"d47c7da77fdcff6d70df2e2eda85786f","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"2590331b62716eb28c75c95d85d43a9c","attributes":{"id":"2590331b62716eb28c75c95d85d43a9c","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"90d78c3a5b35f5af9a06ed507cf77a92","attributes":{"id":"90d78c3a5b35f5af9a06ed507cf77a92","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"2a022abe6c8a4e962057188a8f1ae300","attributes":{"id":"2a022abe6c8a4e962057188a8f1ae300","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Circle","id":"2590331b62716eb28c75c95d85d43a9c"},"hover_glyph":{"type":"Circle","id":"90d78c3a5b35f5af9a06ed507cf77a92"},"name":null,"data_source":{"type":"ColumnDataSource","id":"ee1e75dda7e8de30e241d54fe1d5ffe4"},"glyph":{"type":"Circle","id":"d47c7da77fdcff6d70df2e2eda85786f"}}},{"type":"Range1d","id":"df6121307bb445f1eb3206f37059c539","attributes":{"id":"df6121307bb445f1eb3206f37059c539","tags":[],"start":-0.1,"end":2.3}},{"type":"Range1d","id":"46ac767ed90ac800358fd801853953a1","attributes":{"id":"46ac767ed90ac800358fd801853953a1","tags":[],"start":-4.03459,"end":2.96159}},{"type":"LinearAxis","id":"c1acbfe1111cd816d3e1db352aeac3a5","attributes":{"id":"c1acbfe1111cd816d3e1db352aeac3a5","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"axis_label":"Age (years)","formatter":{"type":"BasicTickFormatter","id":"7b0172c829e52e9831a9305fe6127ba5"},"ticker":{"type":"BasicTicker","id":"501caddeade87fca3a16b31532f1f911"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"7b0172c829e52e9831a9305fe6127ba5","attributes":{"id":"7b0172c829e52e9831a9305fe6127ba5","tags":[]}},{"type":"BasicTicker","id":"501caddeade87fca3a16b31532f1f911","attributes":{"id":"501caddeade87fca3a16b31532f1f911","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"6d6d531c4d888958afa82026a4a5ebb2","attributes":{"id":"6d6d531c4d888958afa82026a4a5ebb2","tags":[],"dimension":0,"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"501caddeade87fca3a16b31532f1f911"}}},{"type":"LinearAxis","id":"78cc0248c8f8e4d25c2888d17e042160","attributes":{"id":"78cc0248c8f8e4d25c2888d17e042160","tags":[],"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"axis_label":"Height SDS","formatter":{"type":"BasicTickFormatter","id":"82de4eb4444cffa8b4c5d5078fee770c"},"ticker":{"type":"BasicTicker","id":"b1cbe8389acc3218f0ebc981c898ab3e"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"82de4eb4444cffa8b4c5d5078fee770c","attributes":{"id":"82de4eb4444cffa8b4c5d5078fee770c","tags":[]}},{"type":"BasicTicker","id":"b1cbe8389acc3218f0ebc981c898ab3e","attributes":{"id":"b1cbe8389acc3218f0ebc981c898ab3e","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"13ac309301d1ecf463009b8bba1177e6","attributes":{"id":"13ac309301d1ecf463009b8bba1177e6","tags":[],"dimension":1,"plot":{"type":"Plot","id":"8870e277bae794382c6eae0e0c2064dd","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"b1cbe8389acc3218f0ebc981c898ab3e"}}}]}}},"debug":false},"evals":[],"jsHooks":[]}</script><p class="caption">
Height SDS by age (years) for 50 children of SMOCC.
</p>
</div>
<p>Figure x shows an alternative representation of the same data by replacing height by height SDS. This figure reveals additional detail.</p>
<p>Note that the data contain some outliers, especially at the lower end. For example, child 10059 was born after a gestational age of 34 weeks and has several extremely low SDS values. Child 10023 was born after 32 weeks of gestation.</p>
</div>
<div id="define-knots" class="section level2">
<h2 class="hasAnchor">
<a href="#define-knots" class="anchor"></a>Define knots</h2>
<p>The SMOCC study had 10 scheduled visits: at birth, and at ages of 1, 2, 3, 6, 9, 12, 15, 18 and 24 months. Here, we are interested in estimating what the most likely value would have been had the visit occured exactly on the schedules age. We therefore place the knots at the scheduled ages.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">knots</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">24</span>)/<span class="fl">12</span>, <span class="fl">4</span>)
<span class="no">boundary</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">3</span>)</pre></body></html></div>
<p>In order to obtain the properties of the brokenstick model, the first knot should coincide with the left boundary knot (here 0), while the right boundary (here 3) must exceed than the maximum age in the data.</p>
<p>Note that this is not the only way to set knots. Depending of the scientific question at hand, we could place vary the number of knots, or place them at different locations. See the vignette on <a href="https://stefvanbuuren.name/brokenstick/articles/knotplacement.html">knot placement</a> for a discussion of various options.</p>
</div>
<div id="fit-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-the-model" class="anchor"></a>Fit the model</h2>
<p>The <code><a href="../reference/brokenstick.html">brokenstick()</a></code> function performs the actual model fitting, e.g.,</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">data</span>, <span class="fu"><a href="../reference/brokenstick.html">brokenstick</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">hgt.z</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">data</span>$<span class="no">age</span>, <span class="kw">subjid</span> <span class="kw">=</span> <span class="no">subjid</span>,
                              <span class="kw">knots</span> <span class="kw">=</span> <span class="no">knots</span>, <span class="kw">boundary</span> <span class="kw">=</span> <span class="no">boundary</span>))</pre></body></html></div>
<pre><code>## Warning: number of observations (=484) &lt;= number of random effects (=550) for
## term (0 + x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11 | subjid); the
## random-effects parameters and the residual variance (or scale parameter) are
## probably unidentifiable</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<p>The result is stored in the <code>fit</code> object, which has S4 class <code>brokenstick</code>. It extends class <code>lmerMod</code> with additional attributes <code>knots</code>, <code>boundary</code> and <code>degree</code>. By design, the <code><a href="../reference/brokenstick.html">brokenstick()</a></code> function only supports a one spline degree, the straight line model.</p>
<p>Behind the scenes, the <code><a href="../reference/brokenstick.html">brokenstick()</a></code> function calls <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lme4::lmer()</a></code> for performing the calculations. Depending on the number of knots, the fitting algorithm may issue warnings about the number of random effect (too high), or reports the random-effects parameters or residual variance are probably unidentifiable. Despite these warnings, the estimated random effects are still useable, and in fact a good summary of the individual trajectories. Alternatively, the user may wish to simplify the model by removing knots. Above 10 knots, fitting becomes hard. At the least, the user should check the fitted object for plausibility, for example by plotting observed and modelled trajectories together.</p>
</div>
<div id="interpret-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#interpret-the-model" class="anchor"></a>Interpret the model</h2>
<p>Let us first extract the fixed effects and the corresponding knot locations.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw pkg">lme4</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(<span class="no">fit</span>), <span class="fl">2</span>)</pre></body></html></div>
<pre><code>##    x1    x2    x3    x4    x5    x6    x7    x8    x9   x10   x11 
## -0.08  0.40  0.31  0.35  0.23  0.00  0.04  0.11  0.02  0.13 -0.32</code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="../reference/get_knots.html">get_knots</a></span>(<span class="no">fit</span>), <span class="fl">2</span>)</pre></body></html></div>
<pre><code>##  [1] 0.00 0.08 0.17 0.25 0.50 0.75 1.00 1.25 1.50 2.00 3.00</code></pre>
<p>The fixed effects correspond to the mean of sample of children in the data. The mean development over all 206 children may be plotted as:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu">figure</span>(<span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Age (years)"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_label.html">get_label</a></span>(<span class="st">"haz"</span>), <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Mean trajectory (n = 50)"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ly_zband</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">2.2</span>, <span class="fl">0.2</span>), <span class="kw">z</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.5</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ly_points</span>(<span class="fu"><a href="../reference/get_knots.html">get_knots</a></span>(<span class="no">fit</span>, <span class="st">"droplast"</span>), <span class="kw pkg">lme4</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(<span class="no">fit</span>), <span class="kw">hover</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="../reference/get_knots.html">get_knots</a></span>(<span class="no">fit</span>), <span class="kw pkg">lme4</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(<span class="no">fit</span>))) <span class="kw">%&gt;%</span>
  <span class="fu">ly_lines</span>(<span class="fu"><a href="../reference/get_knots.html">get_knots</a></span>(<span class="no">fit</span>, <span class="st">"droplast"</span>), <span class="kw pkg">lme4</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(<span class="no">fit</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">x_range</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.1</span>, <span class="fl">2.3</span>))</pre></body></html></div>
<div id="htmlwidget-12322c62072532cc0c98" style="width:700px;height:432.632880098888px;" class="rbokeh html-widget"></div>
<script type="application/json" data-for="htmlwidget-12322c62072532cc0c98">{"x":{"elementid":"a94035d000867ee8f385a04d7893408d","modeltype":"Plot","modelid":"991fd4a1dfa1ba8c2b4a0ffb9f501127","docid":"a398123414c3a18e7a5d1b46d80d6b1d","docs_json":{"a398123414c3a18e7a5d1b46d80d6b1d":{"version":"0.12.5","title":"Bokeh Figure","roots":{"root_ids":["991fd4a1dfa1ba8c2b4a0ffb9f501127"],"references":[{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","attributes":{"id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","sizing_mode":"scale_both","x_range":{"type":"Range1d","id":"b954366bcf1d205fbb5aae1d6bd6d114"},"y_range":{"type":"Range1d","id":"7f3ae17ac25801dd9753c11f700f877f"},"left":[{"type":"LinearAxis","id":"1f4b0ec53a9286ab63bc5b7559dfb272"}],"below":[{"type":"LinearAxis","id":"76d958f53ad198a3261c6670a0be2265"}],"right":[],"above":[],"renderers":[{"type":"BoxAnnotation","id":"4805793476d2845e11cf8619beb03c4f"},{"type":"GlyphRenderer","id":"8c9e6e165eb8d88d495a97788a7db713"},{"type":"GlyphRenderer","id":"51b141df95db24b212cac0b4250a0f3f"},{"type":"GlyphRenderer","id":"50291d9197174dc738f8fddaa620899a"},{"type":"GlyphRenderer","id":"2465cfc07ec78358110101e3815081ae"},{"type":"GlyphRenderer","id":"94e2a17e488cf201e335a12e87adcbc6"},{"type":"GlyphRenderer","id":"a6303ceea42bc7a1beb35d8d6e7de2ff"},{"type":"GlyphRenderer","id":"d3f18972e1f75058e2aa578cf51983e2"},{"type":"LinearAxis","id":"76d958f53ad198a3261c6670a0be2265"},{"type":"Grid","id":"95d3bf38c4d4527c8c4565f87cad054b"},{"type":"LinearAxis","id":"1f4b0ec53a9286ab63bc5b7559dfb272"},{"type":"Grid","id":"c0d4053db0e2bfc29a3173a3014e3f03"}],"extra_y_ranges":{},"extra_x_ranges":{},"tags":[],"min_border_left":4,"min_border_right":4,"min_border_top":4,"min_border_bottom":4,"lod_threshold":null,"toolbar":{"type":"Toolbar","id":"6158baa281daec5e4364532f6eef6f17"},"tool_events":{"type":"ToolEvents","id":"c76a16b98ad25f9824de9da42f93b951"},"title":{"type":"Title","id":"c154b98e08fe10b80e3d40bd9241b0c8"}},"subtype":"Figure"},{"type":"Toolbar","id":"6158baa281daec5e4364532f6eef6f17","attributes":{"id":"6158baa281daec5e4364532f6eef6f17","tags":[],"active_drag":"auto","active_scroll":"auto","active_tap":"auto","tools":[{"type":"PanTool","id":"4e05327d062a9b62d3b8f7ea536dcc9f"},{"type":"WheelZoomTool","id":"0963ccc249f38bfbdd7d65803a1dd0f7"},{"type":"BoxZoomTool","id":"371a86306151e636722f191af354abe6"},{"type":"ResetTool","id":"d130ddcd593758ae9271e8612e976acb"},{"type":"SaveTool","id":"5794ef9603453a925c513b5cb762a70e"},{"type":"HelpTool","id":"8a28817a724f4b52fb8d935189acf4db"},{"type":"HoverTool","id":"b05766932bbc1bb0feceddbe8c0e6987"}],"logo":null}},{"type":"PanTool","id":"4e05327d062a9b62d3b8f7ea536dcc9f","attributes":{"id":"4e05327d062a9b62d3b8f7ea536dcc9f","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"dimensions":"both"}},{"type":"ToolEvents","id":"c76a16b98ad25f9824de9da42f93b951","attributes":{"id":"c76a16b98ad25f9824de9da42f93b951","tags":[]},"geometries":[]},{"type":"WheelZoomTool","id":"0963ccc249f38bfbdd7d65803a1dd0f7","attributes":{"id":"0963ccc249f38bfbdd7d65803a1dd0f7","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"dimensions":"both"}},{"type":"BoxAnnotation","id":"4805793476d2845e11cf8619beb03c4f","attributes":{"id":"4805793476d2845e11cf8619beb03c4f","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"fill_color":{"units":"data","value":"lightgrey"},"fill_alpha":{"units":"data","value":0.5},"line_dash":[4,4],"line_width":{"units":"data","value":2},"level":"overlay","top_units":"screen","bottom_units":"screen","left_units":"screen","right_units":"screen","render_mode":"css"}},{"type":"BoxZoomTool","id":"371a86306151e636722f191af354abe6","attributes":{"id":"371a86306151e636722f191af354abe6","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"overlay":{"type":"BoxAnnotation","id":"4805793476d2845e11cf8619beb03c4f"}}},{"type":"ResetTool","id":"d130ddcd593758ae9271e8612e976acb","attributes":{"id":"d130ddcd593758ae9271e8612e976acb","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"}}},{"type":"SaveTool","id":"5794ef9603453a925c513b5cb762a70e","attributes":{"id":"5794ef9603453a925c513b5cb762a70e","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"}}},{"type":"HelpTool","id":"8a28817a724f4b52fb8d935189acf4db","attributes":{"id":"8a28817a724f4b52fb8d935189acf4db","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"redirect":"http://hafen.github.io/rbokeh","help_tooltip":"Click to learn more about rbokeh."}},{"type":"Title","id":"c154b98e08fe10b80e3d40bd9241b0c8","attributes":{"id":"c154b98e08fe10b80e3d40bd9241b0c8","tags":[],"plot":null,"text":"Mean trajectory (n = 50)"}},{"type":"ColumnDataSource","id":"5d5f6d56e91e50348a231bd1f3e86d39","attributes":{"id":"5d5f6d56e91e50348a231bd1f3e86d39","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-2.5,-2.5,2.5,2.5]]}}},{"type":"Patches","id":"432baa0d84d09a450f25ff6db1a07fa3","attributes":{"id":"432baa0d84d09a450f25ff6db1a07fa3","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"ff6999d2ef94bc3cf5084229c074870d","attributes":{"id":"ff6999d2ef94bc3cf5084229c074870d","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"0a7a302f23bf84bca302efbe617093e2","attributes":{"id":"0a7a302f23bf84bca302efbe617093e2","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"8c9e6e165eb8d88d495a97788a7db713","attributes":{"id":"8c9e6e165eb8d88d495a97788a7db713","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"ff6999d2ef94bc3cf5084229c074870d"},"hover_glyph":{"type":"Patches","id":"0a7a302f23bf84bca302efbe617093e2"},"name":null,"data_source":{"type":"ColumnDataSource","id":"5d5f6d56e91e50348a231bd1f3e86d39"},"glyph":{"type":"Patches","id":"432baa0d84d09a450f25ff6db1a07fa3"}}},{"type":"ColumnDataSource","id":"e1c0d87ac41f1955ea285004781c93ae","attributes":{"id":"e1c0d87ac41f1955ea285004781c93ae","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-2,-2,2,2]]}}},{"type":"Patches","id":"5546f3b28661a2be1550512022346677","attributes":{"id":"5546f3b28661a2be1550512022346677","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"c4b0fe3d2a032e5969d96c125050d1e7","attributes":{"id":"c4b0fe3d2a032e5969d96c125050d1e7","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"54a17d4016c506ffda1be52d94697e85","attributes":{"id":"54a17d4016c506ffda1be52d94697e85","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"51b141df95db24b212cac0b4250a0f3f","attributes":{"id":"51b141df95db24b212cac0b4250a0f3f","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"c4b0fe3d2a032e5969d96c125050d1e7"},"hover_glyph":{"type":"Patches","id":"54a17d4016c506ffda1be52d94697e85"},"name":null,"data_source":{"type":"ColumnDataSource","id":"e1c0d87ac41f1955ea285004781c93ae"},"glyph":{"type":"Patches","id":"5546f3b28661a2be1550512022346677"}}},{"type":"ColumnDataSource","id":"a82550b6c8ad41b9821cac89bd899164","attributes":{"id":"a82550b6c8ad41b9821cac89bd899164","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-1,-1,1,1]]}}},{"type":"Patches","id":"4dfcde5a9b12ef17315da86052ce7559","attributes":{"id":"4dfcde5a9b12ef17315da86052ce7559","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"35933d4cce14cdceacd15b24c1b1c488","attributes":{"id":"35933d4cce14cdceacd15b24c1b1c488","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"c715bb2f7f41b795554bad328ee9b87a","attributes":{"id":"c715bb2f7f41b795554bad328ee9b87a","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"50291d9197174dc738f8fddaa620899a","attributes":{"id":"50291d9197174dc738f8fddaa620899a","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"35933d4cce14cdceacd15b24c1b1c488"},"hover_glyph":{"type":"Patches","id":"c715bb2f7f41b795554bad328ee9b87a"},"name":null,"data_source":{"type":"ColumnDataSource","id":"a82550b6c8ad41b9821cac89bd899164"},"glyph":{"type":"Patches","id":"4dfcde5a9b12ef17315da86052ce7559"}}},{"type":"ColumnDataSource","id":"a07e6cd4e329c705858e83344ecd8319","attributes":{"id":"a07e6cd4e329c705858e83344ecd8319","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,2.2,2.2,0]],"ys":[[-0,-0,0,0]]}}},{"type":"Patches","id":"7aae09515a14292d77d107be0e379fff","attributes":{"id":"7aae09515a14292d77d107be0e379fff","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"e70633cfa98df1136365fac9ad2e4300","attributes":{"id":"e70633cfa98df1136365fac9ad2e4300","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"fc851bc70175a5cc558afccfca0b8dbe","attributes":{"id":"fc851bc70175a5cc558afccfca0b8dbe","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"2465cfc07ec78358110101e3815081ae","attributes":{"id":"2465cfc07ec78358110101e3815081ae","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"e70633cfa98df1136365fac9ad2e4300"},"hover_glyph":{"type":"Patches","id":"fc851bc70175a5cc558afccfca0b8dbe"},"name":null,"data_source":{"type":"ColumnDataSource","id":"a07e6cd4e329c705858e83344ecd8319"},"glyph":{"type":"Patches","id":"7aae09515a14292d77d107be0e379fff"}}},{"type":"ColumnDataSource","id":"6e671071f5fc3d8a889049671267efc9","attributes":{"id":"6e671071f5fc3d8a889049671267efc9","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,2.2],"y":[0,0]}}},{"type":"Line","id":"366c93b90e0b271f2c47829ea39eb8ee","attributes":{"id":"366c93b90e0b271f2c47829ea39eb8ee","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"dba21680e176555a9dbaad34ae3c0195","attributes":{"id":"dba21680e176555a9dbaad34ae3c0195","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"a0f0528267819f62564bd60b93b8ca7e","attributes":{"id":"a0f0528267819f62564bd60b93b8ca7e","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"94e2a17e488cf201e335a12e87adcbc6","attributes":{"id":"94e2a17e488cf201e335a12e87adcbc6","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Line","id":"dba21680e176555a9dbaad34ae3c0195"},"hover_glyph":{"type":"Line","id":"a0f0528267819f62564bd60b93b8ca7e"},"name":null,"data_source":{"type":"ColumnDataSource","id":"6e671071f5fc3d8a889049671267efc9"},"glyph":{"type":"Line","id":"366c93b90e0b271f2c47829ea39eb8ee"}}},{"type":"HoverTool","id":"b05766932bbc1bb0feceddbe8c0e6987","attributes":{"id":"b05766932bbc1bb0feceddbe8c0e6987","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"renderers":[{"type":"GlyphRenderer","id":"a6303ceea42bc7a1beb35d8d6e7de2ff"}],"names":[],"anchor":"center","attachment":"horizontal","line_policy":"prev","mode":"mouse","point_policy":"snap_to_data","tooltips":[["get_knots(fit)","@hover_col_1"],["lme4::fixef(fit)","@hover_col_2"]]}},{"type":"ColumnDataSource","id":"b6d47fa2da6bcab419a27535502d0914","attributes":{"id":"b6d47fa2da6bcab419a27535502d0914","tags":[],"column_names":["x","y","hover_col_1","hover_col_2"],"selected":[],"data":{"x":[0,0.0833,0.1667,0.25,0.5,0.75,1,1.25,1.5,2],"y":[-0.0827536979060232,0.398328017812364,0.311552959874531,0.350124344961375,0.228374241105905,-0.00177121547847037,0.0397419574911966,0.113818387243209,0.0178448033141304,0.127693923074822],"hover_col_1":["0.0000","0.0833","0.1667","0.2500","0.5000","0.7500","1.0000","1.2500","1.5000","2.0000"],"hover_col_2":["-0.082753698"," 0.398328018"," 0.311552960"," 0.350124345"," 0.228374241","-0.001771215"," 0.039741957"," 0.113818387"," 0.017844803"," 0.127693923"]}}},{"type":"Circle","id":"59501a3243ec726516c3d337af26de9b","attributes":{"id":"59501a3243ec726516c3d337af26de9b","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"b01247f0aa7bdb904244fb28c7367c33","attributes":{"id":"b01247f0aa7bdb904244fb28c7367c33","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"33458cb9ffb6f45af0f6d486372f684e","attributes":{"id":"33458cb9ffb6f45af0f6d486372f684e","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"a6303ceea42bc7a1beb35d8d6e7de2ff","attributes":{"id":"a6303ceea42bc7a1beb35d8d6e7de2ff","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Circle","id":"b01247f0aa7bdb904244fb28c7367c33"},"hover_glyph":{"type":"Circle","id":"33458cb9ffb6f45af0f6d486372f684e"},"name":null,"data_source":{"type":"ColumnDataSource","id":"b6d47fa2da6bcab419a27535502d0914"},"glyph":{"type":"Circle","id":"59501a3243ec726516c3d337af26de9b"}}},{"type":"ColumnDataSource","id":"12ebfc3f88ae1b40395e516d421791f3","attributes":{"id":"12ebfc3f88ae1b40395e516d421791f3","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,0.0833,0.1667,0.25,0.5,0.75,1,1.25,1.5,2],"y":[-0.0827536979060232,0.398328017812364,0.311552959874531,0.350124344961375,0.228374241105905,-0.00177121547847037,0.0397419574911966,0.113818387243209,0.0178448033141304,0.127693923074822]}}},{"type":"Line","id":"9084e925500af87f88f7dfddca760fdc","attributes":{"id":"9084e925500af87f88f7dfddca760fdc","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"c299721074de736721c674c0d72ac263","attributes":{"id":"c299721074de736721c674c0d72ac263","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"c0ca85f61e4ada3adf6d7768fc4ec66c","attributes":{"id":"c0ca85f61e4ada3adf6d7768fc4ec66c","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"d3f18972e1f75058e2aa578cf51983e2","attributes":{"id":"d3f18972e1f75058e2aa578cf51983e2","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Line","id":"c299721074de736721c674c0d72ac263"},"hover_glyph":{"type":"Line","id":"c0ca85f61e4ada3adf6d7768fc4ec66c"},"name":null,"data_source":{"type":"ColumnDataSource","id":"12ebfc3f88ae1b40395e516d421791f3"},"glyph":{"type":"Line","id":"9084e925500af87f88f7dfddca760fdc"}}},{"type":"Range1d","id":"b954366bcf1d205fbb5aae1d6bd6d114","attributes":{"id":"b954366bcf1d205fbb5aae1d6bd6d114","tags":[],"start":-0.1,"end":2.3}},{"type":"Range1d","id":"7f3ae17ac25801dd9753c11f700f877f","attributes":{"id":"7f3ae17ac25801dd9753c11f700f877f","tags":[],"start":-2.85,"end":2.85}},{"type":"LinearAxis","id":"76d958f53ad198a3261c6670a0be2265","attributes":{"id":"76d958f53ad198a3261c6670a0be2265","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"axis_label":"Age (years)","formatter":{"type":"BasicTickFormatter","id":"9a87034c4747148eafa61493069896ee"},"ticker":{"type":"BasicTicker","id":"1ba14019e350041244e3518d16f0ea91"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"9a87034c4747148eafa61493069896ee","attributes":{"id":"9a87034c4747148eafa61493069896ee","tags":[]}},{"type":"BasicTicker","id":"1ba14019e350041244e3518d16f0ea91","attributes":{"id":"1ba14019e350041244e3518d16f0ea91","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"95d3bf38c4d4527c8c4565f87cad054b","attributes":{"id":"95d3bf38c4d4527c8c4565f87cad054b","tags":[],"dimension":0,"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"1ba14019e350041244e3518d16f0ea91"}}},{"type":"LinearAxis","id":"1f4b0ec53a9286ab63bc5b7559dfb272","attributes":{"id":"1f4b0ec53a9286ab63bc5b7559dfb272","tags":[],"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"axis_label":"Length/height for age z-score","formatter":{"type":"BasicTickFormatter","id":"1ee1aa11c7d1f8bc0e9ccfa12b03f38b"},"ticker":{"type":"BasicTicker","id":"340500d0a7e4c62a6f74e54ba5983282"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"1ee1aa11c7d1f8bc0e9ccfa12b03f38b","attributes":{"id":"1ee1aa11c7d1f8bc0e9ccfa12b03f38b","tags":[]}},{"type":"BasicTicker","id":"340500d0a7e4c62a6f74e54ba5983282","attributes":{"id":"340500d0a7e4c62a6f74e54ba5983282","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"c0d4053db0e2bfc29a3173a3014e3f03","attributes":{"id":"c0d4053db0e2bfc29a3173a3014e3f03","tags":[],"dimension":1,"plot":{"type":"Plot","id":"991fd4a1dfa1ba8c2b4a0ffb9f501127","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"340500d0a7e4c62a6f74e54ba5983282"}}}]}}},"debug":false},"evals":[],"jsHooks":[]}</script><p>At birth, the 50 children are on average 0.08 SD shorter than the Dutch standard. At months 1, 2, 3, the mean height of the 50 children is 0.40 SD, 0.31 SD and 0.35 SD higher than the Dutch references. After that, there average trajectory consistently stays slightly above the mean in the reference. The estimate for <code>x11</code> (-0.32 SD), corresponding to the age of 3 years is just there for technical reasons. The last knot (here 3 years) of the broken stick model has no interpretation, and should be disregarded.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">fit</span></pre></body></html></div>
<pre><code>## Linear mixed model fit by REML ['brokenstick']
## Formula: y ~ 0 + x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11 +  
##     (0 + x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11 |  
##         subjid)
##    Data: data
## REML criterion at convergence: 670.3359
## Random effects:
##  Groups   Name Std.Dev. Corr                                                 
##  subjid   x1   1.1850                                                        
##           x2   0.9895    0.78                                                
##           x3   1.1521    0.72  0.89                                          
##           x4   0.9496    0.70  0.90  0.89                                    
##           x5   0.9370    0.49  0.79  0.84  0.83                              
##           x6   0.9154    0.52  0.74  0.75  0.75  0.95                        
##           x7   0.8857    0.44  0.64  0.61  0.54  0.83  0.87                  
##           x8   0.9634    0.31  0.60  0.55  0.50  0.71  0.78  0.86            
##           x9   0.9730    0.34  0.62  0.60  0.55  0.76  0.81  0.87  0.94      
##           x10  1.0906    0.12  0.52  0.57  0.50  0.79  0.76  0.82  0.81  0.92
##           x11  6.6152    0.09 -0.16 -0.30 -0.20 -0.52 -0.36 -0.37  0.00 -0.14
##  Residual      0.1896                                                        
##       
##       
##       
##       
##       
##       
##       
##       
##       
##       
##       
##  -0.46
##       
## Number of obs: 484, groups:  subjid, 50
## Fixed Effects:
##        x1         x2         x3         x4         x5         x6         x7  
## -0.082754   0.398328   0.311553   0.350124   0.228374  -0.001771   0.039742  
##        x8         x9        x10        x11  
##  0.113818   0.017845   0.127694  -0.320592  
## convergence code 0; 0 optimizer warnings; 1 lme4 warnings</code></pre>
<p>The column labeled <code>Std.Dev.</code> contains the standard deviations of the random effects. These numbers are expected to be around 1, since - under the assumption that Dutch reference appropriately describes this sample - the dependent variable <code>hgt.z</code> follows a standard normal distribution with zero mean and standard deviation equal to one. The <code>Corr</code> component of the random effects lists the correlations between the broken stick estimates at different ages. The correlation matrix shows a typically pattern where the highest elements are close to the diagonal, and where off-diagonal elements decrease. The standard deviation of the residuals (within-person error) for this model is of 0.19, so on average, the discrepancy between observed and fitted trajectories is about one fifth of a standard deviation. At the age of 2 years, the standard deviation in height is about 32 mm, so on average the difference between the model and the observed data is about 6-7 mm.</p>
</div>
<div id="obtain-predicted-values-all-children" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-predicted-values-all-children" class="anchor"></a>Obtain predicted values, all children</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function obtains predictions from the broken stick model. The function is extremely flexible, and allows for prediction of new subjects at arbitrary ages in a variety of output formats. The simplest call</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">p1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">p1</span>, <span class="fl">4</span>)</pre></body></html></div>
<pre><code>##   subjid      x     y      yhat  knot
## 1  10001 0.0000 0.575 0.5117682 FALSE
## 2  10001 0.0821 0.888 0.8762757 FALSE
## 3  10001 0.1588 0.797 0.8107744 FALSE
## 4  10001 0.2546 0.661 0.6530335 FALSE</code></pre>
<p>produces the predicted value (in <code>yhat</code>) for each measured data point for all children used to fit the model in the <code>long</code> output format. The observed <span class="math inline">\(Z\)</span>-score is stored in column called <code>y</code>, and the corresponding broken stick estimates are stored in the column called <code>yhat</code>. The column <code>knot</code> is set to <code>TRUE</code> if the row corresponds to a knot, and to <code>FALSE</code> if <code>y</code> is actually observed.</p>
<p>The predicted values represent a compromise between the personâ€™s data values and the global mean. In general, the fewer and less extreme data points of a person are, the closer the compromise will be toward the global mean. The compromise is called the <em>conditional mean</em> of the posterior distribution. In the broken stick model, it is simply calculated as the sum of the fixed and random effects.</p>
<p>We can obtain the locations at which the lines connect by specifying the <code>at = "knots"</code> argument, e.g.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">p2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="st">"knots"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">p2</span>, <span class="fl">4</span>)</pre></body></html></div>
<pre><code>##   subjid      x  y      yhat knot
## 1  10001 0.0000 NA 0.5117682 TRUE
## 2  10001 0.0833 NA 0.8816035 TRUE
## 3  10001 0.1667 NA 0.8033631 TRUE
## 4  10001 0.2500 NA 0.6603196 TRUE</code></pre>
<p>Note that the column <code>knot</code> is now <code>TRUE</code>. We may obtain both types of estimates simultaneously for all children by using the</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">p3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="st">"both"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">p3</span>, <span class="fl">4</span>)</pre></body></html></div>
<pre><code>##   subjid      x     y      yhat  knot
## 1  10001 0.0000 0.575 0.5117682 FALSE
## 2  10001 0.0821 0.888 0.8762757 FALSE
## 3  10001 0.1588 0.797 0.8107744 FALSE
## 4  10001 0.2546 0.661 0.6530335 FALSE</code></pre>
<p>The first three fitted trajectories are plotted by</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"># plot(fit, x_trim = c(0, 2.3), show_reference = TRUE)</pre></body></html></div>
</div>
<div id="obtain-predicted-values-single-child" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-predicted-values-single-child" class="anchor"></a>Obtain predicted values, single child</h2>
<p>The computationally fastest way to obtain predicted values for just one subject from a fitted model is to specify the <code>ids</code>, <code>at</code> and <code>output</code> arguments as</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">p1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>, <span class="kw">ids</span> <span class="kw">=</span> <span class="fl">10001</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="st">"knots"</span>, <span class="kw">output</span> <span class="kw">=</span> <span class="st">"vector"</span>)</pre></body></html></div>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function can return additional information by altering these arguments. Type <code><a href="../reference/predict.brokenstick.html">?predict.brokenstick</a></code> at the console to see the documentation.</p>
</div>
<div id="plot-a-subset-of-children" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-a-subset-of-children" class="anchor"></a>Plot a subset of children</h2>
<p>We plot the original data and the broken stick estimates for child 10001 jointly as</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">fit</span>, <span class="kw">ids</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10001</span>, <span class="fl">10005</span>, <span class="fl">10022</span>), <span class="kw">x_trim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2.3</span>), <span class="kw">show_reference</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="prediction_files/figure-html/fig3-1.png" width="700"></p>
</div>
<div id="convert-to-original-scale" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-to-original-scale" class="anchor"></a>Convert to original scale</h2>
<p>Modeling was done in the <span class="math inline">\(Z\)</span>-score scale for the reasons given above. We may plot the result in the original scale by back-converting the estimates using the WHO reference, as follows:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># convert Z-score to CM</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>, <span class="kw">ids</span> <span class="kw">=</span> <span class="fl">10001</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="st">"both"</span>)
<span class="no">p</span>$<span class="no">ycm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu">who_zscore2htcm</span>(<span class="fu">years2days</span>(<span class="no">p</span>$<span class="no">x</span>), <span class="no">p</span>$<span class="no">y</span>, <span class="kw">sex</span> <span class="kw">=</span> <span class="st">"Female"</span>), <span class="fl">1</span>)
<span class="no">p</span>$<span class="no">yhatcm</span> <span class="kw">&lt;-</span> <span class="fu">who_zscore2htcm</span>(<span class="fu">years2days</span>(<span class="no">p</span>$<span class="no">x</span>), <span class="no">p</span>$<span class="no">yhat</span>, <span class="kw">sex</span> <span class="kw">=</span> <span class="st">"Female"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">p</span>)</pre></body></html></div>
<pre><code>##         subjid      x      y       yhat  knot  ycm   yhatcm
## 10001.1  10001 0.0000  0.575  0.5117682 FALSE 50.2 50.10097
## 10001.2  10001 0.0821  0.888  0.8762757 FALSE 55.4 55.34210
## 10001.3  10001 0.1588  0.797  0.8107744 FALSE 58.4 58.42549
## 10001.4  10001 0.2546  0.661  0.6530335 FALSE 61.3 61.31615
## 10001.5  10001 0.5038  0.290  0.2564071 FALSE 66.5 66.38629
## 10001.6  10001 0.7529 -0.398 -0.2521086 FALSE 69.2 69.58151</code></pre>
<p>The corresponding figure in the cm scale can be produced as</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> <span class="no">p</span>[<span class="no">p</span>$<span class="no">x</span> <span class="kw">&lt;=</span> <span class="fl">2.5</span>,]
<span class="fu">figure</span>(<span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Age (years)"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_label.html">get_label</a></span>(<span class="st">"htcm"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ly_who</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">750</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">30</span>), <span class="kw">y_var</span> <span class="kw">=</span> <span class="st">"htcm"</span>,
    <span class="kw">x_trans</span> <span class="kw">=</span> <span class="no">days2years</span>, <span class="kw">sex</span> <span class="kw">=</span> <span class="st">"Female"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"green"</span>,
    <span class="kw">p</span> <span class="kw">=</span> <span class="fl">100</span> * <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(-<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.5</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>))) <span class="kw">%&gt;%</span>
  <span class="fu">ly_points</span>(<span class="no">p</span>$<span class="no">x</span>, <span class="no">p</span>$<span class="no">ycm</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ly_lines</span>(<span class="no">p</span>$<span class="no">x</span>[<span class="no">p</span>$<span class="no">knot</span>], <span class="no">p</span>$<span class="no">yhatcm</span>[<span class="no">p</span>$<span class="no">knot</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="st">"orangered"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ly_points</span>(<span class="no">p</span>$<span class="no">x</span>[<span class="no">p</span>$<span class="no">knot</span>], <span class="no">p</span>$<span class="no">yhatcm</span>[<span class="no">p</span>$<span class="no">knot</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="st">"orangered"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>)</pre></body></html></div>
<div id="htmlwidget-f5c162a6aee378369a52" style="width:700px;height:432.632880098888px;" class="rbokeh html-widget"></div>
<script type="application/json" data-for="htmlwidget-f5c162a6aee378369a52">{"x":{"elementid":"ecf97ab899a5aa48e9331a9e07a97c2d","modeltype":"Plot","modelid":"c06edff60f387a952c075132b807b811","docid":"b9825a69c54b58848541ed4a088bce13","docs_json":{"b9825a69c54b58848541ed4a088bce13":{"version":"0.12.5","title":"Bokeh Figure","roots":{"root_ids":["c06edff60f387a952c075132b807b811"],"references":[{"type":"Plot","id":"c06edff60f387a952c075132b807b811","attributes":{"id":"c06edff60f387a952c075132b807b811","sizing_mode":"scale_both","x_range":{"type":"Range1d","id":"8d752569929275790a4d39275648ddd9"},"y_range":{"type":"Range1d","id":"3887aea960671c28272682a568b8859d"},"left":[{"type":"LinearAxis","id":"9753ee88914846a965b7b472327609e5"}],"below":[{"type":"LinearAxis","id":"96973d065e6cc218e1afe371c7c51439"}],"right":[],"above":[],"renderers":[{"type":"BoxAnnotation","id":"8f8595265e9dad9cbc4e4e320ae697a2"},{"type":"GlyphRenderer","id":"732935ba548debf3e257a9af8097f7dd"},{"type":"GlyphRenderer","id":"ec9a5d2dc6532f36df3053ef2cdfd250"},{"type":"GlyphRenderer","id":"30087297ab8a41a5573ced0ad34bc53f"},{"type":"GlyphRenderer","id":"2cb5e241c4c14e7279e7f9fba4d017dc"},{"type":"GlyphRenderer","id":"3afaa4ff268fcded16d5a81fc4c3767c"},{"type":"GlyphRenderer","id":"f23ac73c4153063f66cae7ba4084fbf7"},{"type":"GlyphRenderer","id":"7d4f24187ab88fbd4ef32902efa3a4b0"},{"type":"LinearAxis","id":"96973d065e6cc218e1afe371c7c51439"},{"type":"Grid","id":"54ecdf391d0e2bfc160e32debeaf7d4c"},{"type":"LinearAxis","id":"9753ee88914846a965b7b472327609e5"},{"type":"Grid","id":"85bf034d575b79485540e24a77905680"}],"extra_y_ranges":{},"extra_x_ranges":{},"tags":[],"min_border_left":4,"min_border_right":4,"min_border_top":4,"min_border_bottom":4,"lod_threshold":null,"toolbar":{"type":"Toolbar","id":"96139be2dd39a2b322cdd5884ad7add7"},"tool_events":{"type":"ToolEvents","id":"951446320ac1b22dac9d0b287e59d6da"}},"subtype":"Figure"},{"type":"Toolbar","id":"96139be2dd39a2b322cdd5884ad7add7","attributes":{"id":"96139be2dd39a2b322cdd5884ad7add7","tags":[],"active_drag":"auto","active_scroll":"auto","active_tap":"auto","tools":[{"type":"PanTool","id":"2a8496a03fb3ede43d02de87673a9bbd"},{"type":"WheelZoomTool","id":"b60c24623f2baf97762b67828304fc5a"},{"type":"BoxZoomTool","id":"c2a8e0e362738363bfbd0c7c0b806ed6"},{"type":"ResetTool","id":"3285ffe479d89a279f13c4521627fc9d"},{"type":"SaveTool","id":"d5f23fec3a976e1d6ee10c1f60c2a5f0"},{"type":"HelpTool","id":"cd060fcfefd02fdb9a364f74535550dd"}],"logo":null}},{"type":"PanTool","id":"2a8496a03fb3ede43d02de87673a9bbd","attributes":{"id":"2a8496a03fb3ede43d02de87673a9bbd","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"dimensions":"both"}},{"type":"ToolEvents","id":"951446320ac1b22dac9d0b287e59d6da","attributes":{"id":"951446320ac1b22dac9d0b287e59d6da","tags":[]},"geometries":[]},{"type":"WheelZoomTool","id":"b60c24623f2baf97762b67828304fc5a","attributes":{"id":"b60c24623f2baf97762b67828304fc5a","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"dimensions":"both"}},{"type":"BoxAnnotation","id":"8f8595265e9dad9cbc4e4e320ae697a2","attributes":{"id":"8f8595265e9dad9cbc4e4e320ae697a2","tags":[],"line_color":{"units":"data","value":"black"},"line_alpha":{"units":"data","value":1},"fill_color":{"units":"data","value":"lightgrey"},"fill_alpha":{"units":"data","value":0.5},"line_dash":[4,4],"line_width":{"units":"data","value":2},"level":"overlay","top_units":"screen","bottom_units":"screen","left_units":"screen","right_units":"screen","render_mode":"css"}},{"type":"BoxZoomTool","id":"c2a8e0e362738363bfbd0c7c0b806ed6","attributes":{"id":"c2a8e0e362738363bfbd0c7c0b806ed6","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"overlay":{"type":"BoxAnnotation","id":"8f8595265e9dad9cbc4e4e320ae697a2"}}},{"type":"ResetTool","id":"3285ffe479d89a279f13c4521627fc9d","attributes":{"id":"3285ffe479d89a279f13c4521627fc9d","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"}}},{"type":"SaveTool","id":"d5f23fec3a976e1d6ee10c1f60c2a5f0","attributes":{"id":"d5f23fec3a976e1d6ee10c1f60c2a5f0","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"}}},{"type":"HelpTool","id":"cd060fcfefd02fdb9a364f74535550dd","attributes":{"id":"cd060fcfefd02fdb9a364f74535550dd","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"redirect":"http://hafen.github.io/rbokeh","help_tooltip":"Click to learn more about rbokeh."}},{"type":"ColumnDataSource","id":"264ef84ba9a240fe9ec7901725b86f86","attributes":{"id":"264ef84ba9a240fe9ec7901725b86f86","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,0.082135523613963,0.164271047227926,0.246406570841889,0.328542094455852,0.410677618069815,0.492813141683778,0.574948665297741,0.657084188911704,0.739219712525667,0.82135523613963,0.903490759753593,0.985626283367556,1.06776180698152,1.14989733059548,1.23203285420945,1.31416837782341,1.39630390143737,1.47843942505133,1.5605749486653,1.64271047227926,1.72484599589322,1.80698151950719,1.88911704312115,1.97125256673511,2.05338809034908,2.05338809034908,1.97125256673511,1.88911704312115,1.80698151950719,1.72484599589322,1.64271047227926,1.5605749486653,1.47843942505133,1.39630390143737,1.31416837782341,1.23203285420945,1.14989733059548,1.06776180698152,0.985626283367556,0.903490759753593,0.82135523613963,0.739219712525667,0.657084188911704,0.574948665297741,0.492813141683778,0.410677618069815,0.328542094455852,0.246406570841889,0.164271047227926,0.082135523613963,0]],"ys":[[44.490955425,48.750692585,51.894990375,54.44053002,56.566487295,58.36626,59.9355074025,61.3601686125,62.687147,63.944224905,65.141830935,66.28924919,67.38988454,68.4468830325,69.46629864,70.450466625,71.402178375,72.323768715,73.21858146,74.08626232,74.93056748,75.7505431875,76.55100906,77.32835578,78.087855965,78.12922401,94.42717599,94.129944035,93.11104422,92.06819094,91.0044568125,89.91503252,88.80333768,87.66601854,86.503031285,85.310421625,84.088533375,82.83450136,81.5449169675,80.21691546,78.85115081,77.443369065,75.988975095,74.483853,72.9108313875,71.2466925975,69.43374,67.370712705,64.94986998,62.066009625,58.514507415,53.804444575]]}}},{"type":"Patches","id":"4d09ef9ef453df7d79157ad4662b26a0","attributes":{"id":"4d09ef9ef453df7d79157ad4662b26a0","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"8cce73031f491d42ee9877f6c5a59ba6","attributes":{"id":"8cce73031f491d42ee9877f6c5a59ba6","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"5514fa27b7db6b5e916aee3037c7567e","attributes":{"id":"5514fa27b7db6b5e916aee3037c7567e","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"732935ba548debf3e257a9af8097f7dd","attributes":{"id":"732935ba548debf3e257a9af8097f7dd","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"8cce73031f491d42ee9877f6c5a59ba6"},"hover_glyph":{"type":"Patches","id":"5514fa27b7db6b5e916aee3037c7567e"},"name":null,"data_source":{"type":"ColumnDataSource","id":"264ef84ba9a240fe9ec7901725b86f86"},"glyph":{"type":"Patches","id":"4d09ef9ef453df7d79157ad4662b26a0"}}},{"type":"ColumnDataSource","id":"f6b55a56d004824ce6ecbc0c903da4be","attributes":{"id":"f6b55a56d004824ce6ecbc0c903da4be","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,0.082135523613963,0.164271047227926,0.246406570841889,0.328542094455852,0.410677618069815,0.492813141683778,0.574948665297741,0.657084188911704,0.739219712525667,0.82135523613963,0.903490759753593,0.985626283367556,1.06776180698152,1.14989733059548,1.23203285420945,1.31416837782341,1.39630390143737,1.47843942505133,1.5605749486653,1.64271047227926,1.72484599589322,1.80698151950719,1.88911704312115,1.97125256673511,2.05338809034908,2.05338809034908,1.97125256673511,1.88911704312115,1.80698151950719,1.72484599589322,1.64271047227926,1.5605749486653,1.47843942505133,1.39630390143737,1.31416837782341,1.23203285420945,1.14989733059548,1.06776180698152,0.985626283367556,0.903490759753593,0.82135523613963,0.739219712525667,0.657084188911704,0.574948665297741,0.492813141683778,0.410677618069815,0.328542094455852,0.246406570841889,0.164271047227926,0.082135523613963,0]],"ys":[[45.42230434,49.727074068,52.9120923,55.491464016,57.646909836,59.473008,61.066625922,62.51523489,63.8668176,65.148699924,66.371984748,67.545439352,68.672587632,69.756686426,70.803118912,71.8142733,72.7930027,73.741694972,74.663325168,75.557969856,76.429013984,77.27593455,78.102727248,78.906624624,79.692064772,79.759019208,92.797380792,92.525735228,91.532775376,90.516472752,89.47906545,88.416586016,87.331630144,86.221274832,85.085105028,83.9195973,82.7247267,81.497681088,80.235113574,78.934212368,77.594960648,76.213215252,74.784500076,73.3041824,71.75576511,70.115574078,68.326992,66.290290164,63.898935984,61.0489077,57.538125932,52.87309566]]}}},{"type":"Patches","id":"c423a9b5667a21c42e856bf3853faeb7","attributes":{"id":"c423a9b5667a21c42e856bf3853faeb7","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"5d695da08349fc50cf2d3863e5479639","attributes":{"id":"5d695da08349fc50cf2d3863e5479639","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"15e65c2965f8ec02a60aa590c1315a09","attributes":{"id":"15e65c2965f8ec02a60aa590c1315a09","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"ec9a5d2dc6532f36df3053ef2cdfd250","attributes":{"id":"ec9a5d2dc6532f36df3053ef2cdfd250","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"5d695da08349fc50cf2d3863e5479639"},"hover_glyph":{"type":"Patches","id":"15e65c2965f8ec02a60aa590c1315a09"},"name":null,"data_source":{"type":"ColumnDataSource","id":"f6b55a56d004824ce6ecbc0c903da4be"},"glyph":{"type":"Patches","id":"c423a9b5667a21c42e856bf3853faeb7"}}},{"type":"ColumnDataSource","id":"3cd6622c06572521ba342569bdab29fa","attributes":{"id":"3cd6622c06572521ba342569bdab29fa","tags":[],"column_names":["xs","ys"],"selected":[],"data":{"xs":[[0,0.082135523613963,0.164271047227926,0.246406570841889,0.328542094455852,0.410677618069815,0.492813141683778,0.574948665297741,0.657084188911704,0.739219712525667,0.82135523613963,0.903490759753593,0.985626283367556,1.06776180698152,1.14989733059548,1.23203285420945,1.31416837782341,1.39630390143737,1.47843942505133,1.5605749486653,1.64271047227926,1.72484599589322,1.80698151950719,1.88911704312115,1.97125256673511,2.05338809034908,2.05338809034908,1.97125256673511,1.88911704312115,1.80698151950719,1.72484599589322,1.64271047227926,1.5605749486653,1.47843942505133,1.39630390143737,1.31416837782341,1.23203285420945,1.14989733059548,1.06776180698152,0.985626283367556,0.903490759753593,0.82135523613963,0.739219712525667,0.657084188911704,0.574948665297741,0.492813141683778,0.410677618069815,0.328542094455852,0.246406570841889,0.164271047227926,0.082135523613963,0]],"ys":[[47.28500217,51.679837034,54.94629615,57.593332008,59.807754918,61.686504,63.328862961,64.825367445,66.2261588,67.557649962,68.832292374,70.057819676,71.237993816,72.376293213,73.476759456,74.54188665,75.57465135,76.577547486,77.552812584,78.501384928,79.425906992,80.326717275,81.206163624,82.063162312,82.900482386,83.018609604,89.537790396,89.317317614,88.376237688,87.413036376,86.428282725,85.419693008,84.388215072,83.331787416,82.249252514,81.13794865,79.99711335,78.824040544,77.615506787,76.368806184,75.082580324,73.752907626,72.375550038,70.9448412,69.445632555,67.853337039,66.113496,64.129445082,61.797067992,59.01470385,55.585362966,51.01039783]]}}},{"type":"Patches","id":"1e109c0de18a18039493e5ed2164d844","attributes":{"id":"1e109c0de18a18039493e5ed2164d844","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"ab80da43f2bbe7ffb2f59cf80465a558","attributes":{"id":"ab80da43f2bbe7ffb2f59cf80465a558","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"fill_alpha":{"units":"data","value":0.075},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"Patches","id":"166a8af9ae0fc9598792ece7cdbf08f7","attributes":{"id":"166a8af9ae0fc9598792ece7cdbf08f7","tags":[],"line_color":{"units":"data","value":"green"},"fill_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"xs":{"units":"data","field":"xs"},"ys":{"units":"data","field":"ys"}}},{"type":"GlyphRenderer","id":"30087297ab8a41a5573ced0ad34bc53f","attributes":{"id":"30087297ab8a41a5573ced0ad34bc53f","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Patches","id":"ab80da43f2bbe7ffb2f59cf80465a558"},"hover_glyph":{"type":"Patches","id":"166a8af9ae0fc9598792ece7cdbf08f7"},"name":null,"data_source":{"type":"ColumnDataSource","id":"3cd6622c06572521ba342569bdab29fa"},"glyph":{"type":"Patches","id":"1e109c0de18a18039493e5ed2164d844"}}},{"type":"ColumnDataSource","id":"b21f4160d82cd55e12a34f1f496344d6","attributes":{"id":"b21f4160d82cd55e12a34f1f496344d6","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,0.082135523613963,0.164271047227926,0.246406570841889,0.328542094455852,0.410677618069815,0.492813141683778,0.574948665297741,0.657084188911704,0.739219712525667,0.82135523613963,0.903490759753593,0.985626283367556,1.06776180698152,1.14989733059548,1.23203285420945,1.31416837782341,1.39630390143737,1.47843942505133,1.5605749486653,1.64271047227926,1.72484599589322,1.80698151950719,1.88911704312115,1.97125256673511,2.05338809034908],"y":[49.1477,53.6326,56.9805,59.6952,61.9686,63.9,65.5911,67.1355,68.5855,69.9666,71.2926,72.5702,73.8034,74.9959,76.1504,77.2695,78.3563,79.4134,80.4423,81.4448,82.4228,83.3775,84.3096,85.2197,86.1089,86.2782]}}},{"type":"Line","id":"2812e25720badf33f910358909bfd0d3","attributes":{"id":"2812e25720badf33f910358909bfd0d3","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"472bc09998895e2d4f4c9c82a6e6ddf4","attributes":{"id":"472bc09998895e2d4f4c9c82a6e6ddf4","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":0.15},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"aabc8adbc9692424b94688860818ea81","attributes":{"id":"aabc8adbc9692424b94688860818ea81","tags":[],"line_color":{"units":"data","value":"green"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"2cb5e241c4c14e7279e7f9fba4d017dc","attributes":{"id":"2cb5e241c4c14e7279e7f9fba4d017dc","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Line","id":"472bc09998895e2d4f4c9c82a6e6ddf4"},"hover_glyph":{"type":"Line","id":"aabc8adbc9692424b94688860818ea81"},"name":null,"data_source":{"type":"ColumnDataSource","id":"b21f4160d82cd55e12a34f1f496344d6"},"glyph":{"type":"Line","id":"2812e25720badf33f910358909bfd0d3"}}},{"type":"ColumnDataSource","id":"96bf1b72488dbdefff851b17470dc8bb","attributes":{"id":"96bf1b72488dbdefff851b17470dc8bb","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,0.0821,0.1588,0.2546,0.5038,0.7529,1.0021,1.1745,1.5661,2.0096,0,0.0833,0.1667,0.25,0.5,0.75,1,1.25,1.5,2],"y":[50.2,55.4,58.4,61.3,66.5,69.2,74.6,77.2,80.5,86.6,null,null,null,null,null,null,null,null,null,null]}}},{"type":"Circle","id":"08f81a5f29f520dbd77700b7b6ff538d","attributes":{"id":"08f81a5f29f520dbd77700b7b6ff538d","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"18dee394ea5c7f65cb9ec0b368ab0e4e","attributes":{"id":"18dee394ea5c7f65cb9ec0b368ab0e4e","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"3540f7726ba2528ad1d9a0ad04a32988","attributes":{"id":"3540f7726ba2528ad1d9a0ad04a32988","tags":[],"size":{"units":"screen","value":10},"line_color":{"units":"data","value":"#1F77B4"},"fill_color":{"units":"data","value":"#1F77B4"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"3afaa4ff268fcded16d5a81fc4c3767c","attributes":{"id":"3afaa4ff268fcded16d5a81fc4c3767c","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Circle","id":"18dee394ea5c7f65cb9ec0b368ab0e4e"},"hover_glyph":{"type":"Circle","id":"3540f7726ba2528ad1d9a0ad04a32988"},"name":null,"data_source":{"type":"ColumnDataSource","id":"96bf1b72488dbdefff851b17470dc8bb"},"glyph":{"type":"Circle","id":"08f81a5f29f520dbd77700b7b6ff538d"}}},{"type":"ColumnDataSource","id":"51d5d12b5802621dd4eed5a5cb788340","attributes":{"id":"51d5d12b5802621dd4eed5a5cb788340","tags":[],"column_names":["x","y"],"selected":[],"data":{"x":[0,0.0833,0.1667,0.25,0.5,0.75,1,1.25,1.5,2],"y":[50.1009694707922,55.4082114338386,58.7043314652148,61.1926880606569,66.3301460841574,69.521697006209,74.5259251812157,77.7321554842838,80.4707375561797,86.2571231971769]}}},{"type":"Line","id":"b7c985c651e82aab64cd22043fed8472","attributes":{"id":"b7c985c651e82aab64cd22043fed8472","tags":[],"line_color":{"units":"data","value":"orangered"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"e43b970a64d78c9960a7a469b62e2f93","attributes":{"id":"e43b970a64d78c9960a7a469b62e2f93","tags":[],"line_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Line","id":"732f4db7d7b27ccbe8df59b2cfd71527","attributes":{"id":"732f4db7d7b27ccbe8df59b2cfd71527","tags":[],"line_color":{"units":"data","value":"orangered"},"line_alpha":{"units":"data","value":1},"line_width":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"f23ac73c4153063f66cae7ba4084fbf7","attributes":{"id":"f23ac73c4153063f66cae7ba4084fbf7","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Line","id":"e43b970a64d78c9960a7a469b62e2f93"},"hover_glyph":{"type":"Line","id":"732f4db7d7b27ccbe8df59b2cfd71527"},"name":null,"data_source":{"type":"ColumnDataSource","id":"51d5d12b5802621dd4eed5a5cb788340"},"glyph":{"type":"Line","id":"b7c985c651e82aab64cd22043fed8472"}}},{"type":"Circle","id":"d0431f2813dbfdd49e8cd04a6e744ccd","attributes":{"id":"d0431f2813dbfdd49e8cd04a6e744ccd","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"orangered"},"fill_color":{"units":"data","value":"orangered"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"c3c16d4a57e9c2cba6594d8253a8207b","attributes":{"id":"c3c16d4a57e9c2cba6594d8253a8207b","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"#e1e1e1"},"fill_color":{"units":"data","value":"#e1e1e1"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":0.5},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"Circle","id":"b4ad05ce0b6516c338522b7092eb2a43","attributes":{"id":"b4ad05ce0b6516c338522b7092eb2a43","tags":[],"size":{"units":"screen","value":6},"line_color":{"units":"data","value":"orangered"},"fill_color":{"units":"data","value":"orangered"},"line_alpha":{"units":"data","value":1},"fill_alpha":{"units":"data","value":1},"x":{"units":"data","field":"x"},"y":{"units":"data","field":"y"}}},{"type":"GlyphRenderer","id":"7d4f24187ab88fbd4ef32902efa3a4b0","attributes":{"id":"7d4f24187ab88fbd4ef32902efa3a4b0","tags":[],"selection_glyph":null,"nonselection_glyph":{"type":"Circle","id":"c3c16d4a57e9c2cba6594d8253a8207b"},"hover_glyph":{"type":"Circle","id":"b4ad05ce0b6516c338522b7092eb2a43"},"name":null,"data_source":{"type":"ColumnDataSource","id":"51d5d12b5802621dd4eed5a5cb788340"},"glyph":{"type":"Circle","id":"d0431f2813dbfdd49e8cd04a6e744ccd"}}},{"type":"Range1d","id":"8d752569929275790a4d39275648ddd9","attributes":{"id":"8d752569929275790a4d39275648ddd9","tags":[],"start":-0.143737166324435,"end":2.19712525667351}},{"type":"Range1d","id":"3887aea960671c28272682a568b8859d","attributes":{"id":"3887aea960671c28272682a568b8859d","tags":[],"start":40.99541998545,"end":97.92271142955}},{"type":"LinearAxis","id":"96973d065e6cc218e1afe371c7c51439","attributes":{"id":"96973d065e6cc218e1afe371c7c51439","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"axis_label":"Age (years)","formatter":{"type":"BasicTickFormatter","id":"d8246e715af55c9a6d4b82a7bddc0d1c"},"ticker":{"type":"BasicTicker","id":"4304425ff4f5bedc13d1d1958adfd3cf"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"d8246e715af55c9a6d4b82a7bddc0d1c","attributes":{"id":"d8246e715af55c9a6d4b82a7bddc0d1c","tags":[]}},{"type":"BasicTicker","id":"4304425ff4f5bedc13d1d1958adfd3cf","attributes":{"id":"4304425ff4f5bedc13d1d1958adfd3cf","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"54ecdf391d0e2bfc160e32debeaf7d4c","attributes":{"id":"54ecdf391d0e2bfc160e32debeaf7d4c","tags":[],"dimension":0,"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"4304425ff4f5bedc13d1d1958adfd3cf"}}},{"type":"LinearAxis","id":"9753ee88914846a965b7b472327609e5","attributes":{"id":"9753ee88914846a965b7b472327609e5","tags":[],"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"axis_label":"Standing height (cm)","formatter":{"type":"BasicTickFormatter","id":"6e9b12720d692ac9d41a73e7408a7cca"},"ticker":{"type":"BasicTicker","id":"1afbe8dcd70eec7996c42c8f44818076"},"visible":true,"axis_label_text_font_size":"12pt"}},{"type":"BasicTickFormatter","id":"6e9b12720d692ac9d41a73e7408a7cca","attributes":{"id":"6e9b12720d692ac9d41a73e7408a7cca","tags":[]}},{"type":"BasicTicker","id":"1afbe8dcd70eec7996c42c8f44818076","attributes":{"id":"1afbe8dcd70eec7996c42c8f44818076","tags":[],"num_minor_ticks":5}},{"type":"Grid","id":"85bf034d575b79485540e24a77905680","attributes":{"id":"85bf034d575b79485540e24a77905680","tags":[],"dimension":1,"plot":{"type":"Plot","id":"c06edff60f387a952c075132b807b811","subtype":"Figure"},"ticker":{"type":"BasicTicker","id":"1afbe8dcd70eec7996c42c8f44818076"}}}]}}},"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="export-and-publish-model" class="section level2">
<h2 class="hasAnchor">
<a href="#export-and-publish-model" class="anchor"></a>Export and publish model</h2>
<p>A brokenstick model like in <code>fit</code> can be stored by <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> for future use in R. However, this is a fairly large object that contains a lot of superfluous information. As a matter of fact, if we know the <code>x</code> and <code>y</code> variables of a given person, prediction using the broken stick model requires only the knot locations, the fixed effect estimates, the variance/covariance matrix of the random effects, and the size of the residual variance. The <code><a href="../reference/export.html">export()</a></code> function will collect this information from the fitted model, and store it as a list.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># export the broken stick models</span>
<span class="no">exp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/export.html">export</a></span>(<span class="no">fit</span>)
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">exp</span>)</pre></body></html></div>
<pre><code>## $names
## [1] "beta"     "omega"    "sigma2"   "knots"    "boundary" "degree"  
## 
## $class
## [1] "brokenstick_export"</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">exp</span>, <span class="no">round</span>, <span class="fl">2</span>)</pre></body></html></div>
<pre><code>## $beta
##    x1    x2    x3    x4    x5    x6    x7    x8    x9   x10   x11 
## -0.08  0.40  0.31  0.35  0.23  0.00  0.04  0.11  0.02  0.13 -0.32 
## 
## $omega
##       x1    x2    x3    x4    x5    x6    x7    x8    x9   x10   x11
## x1  1.40  0.91  0.99  0.79  0.54  0.56  0.46  0.35  0.39  0.16  0.73
## x2  0.91  0.98  1.01  0.84  0.73  0.67  0.56  0.57  0.60  0.56 -1.07
## x3  0.99  1.01  1.33  0.97  0.91  0.79  0.62  0.61  0.68  0.71 -2.28
## x4  0.79  0.84  0.97  0.90  0.74  0.65  0.45  0.46  0.51  0.52 -1.27
## x5  0.54  0.73  0.91  0.74  0.88  0.82  0.69  0.64  0.69  0.81 -3.25
## x6  0.56  0.67  0.79  0.65  0.82  0.84  0.70  0.69  0.72  0.76 -2.20
## x7  0.46  0.56  0.62  0.45  0.69  0.70  0.78  0.74  0.75  0.79 -2.17
## x8  0.35  0.57  0.61  0.46  0.64  0.69  0.74  0.93  0.88  0.85 -0.02
## x9  0.39  0.60  0.68  0.51  0.69  0.72  0.75  0.88  0.95  0.98 -0.87
## x10 0.16  0.56  0.71  0.52  0.81  0.76  0.79  0.85  0.98  1.19 -3.30
## x11 0.73 -1.07 -2.28 -1.27 -3.25 -2.20 -2.17 -0.02 -0.87 -3.30 43.76
## 
## $sigma2
## [1] 0.04
## 
## $knots
## [1] 0.08 0.17 0.25 0.50 0.75 1.00 1.25 1.50 2.00
## 
## $boundary
## [1] 0 3
## 
## $degree
## [1] 1</code></pre>
<p>This set of estimates represents a longitudinal growth reference, and can be published as such.</p>
</div>
<div id="predict-from-the-published-model" class="section level2">
<h2 class="hasAnchor">
<a href="#predict-from-the-published-model" class="anchor"></a>Predict from the published model</h2>
<p>Suppose we have measured a new boy, say Fred. We wish to obtain predictions for Fred using the exported model in <code>exp</code>. The following code calculates these predictions.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="co"># Five age-haz observations for Fred</span>
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.12</span>, <span class="fl">0.32</span>, <span class="fl">0.62</span>, <span class="fl">1.1</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1.2</span>, -<span class="fl">1.8</span>, -<span class="fl">1.7</span>, -<span class="fl">1.9</span>, -<span class="fl">2.1</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">exp</span>, <span class="no">y</span>, <span class="no">x</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="st">"both"</span>, <span class="kw">subjid</span> <span class="kw">=</span> <span class="st">"Fred"</span>)</pre></body></html></div>
<pre><code>##    subjid      x    y      yhat  knot
## 1    Fred 0.0000 -1.2 -1.236658 FALSE
## 2    Fred 0.1200 -1.8 -1.763099 FALSE
## 3    Fred 0.3200 -1.7 -1.626666 FALSE
## 4    Fred 0.6200 -1.9 -1.959124 FALSE
## 5    Fred 1.1000 -2.1 -2.009669 FALSE
## 12   Fred 0.0000   NA -1.236658  TRUE
## 21   Fred 0.0833   NA -1.606816  TRUE
## 31   Fred 0.1667   NA -1.961967  TRUE
## 41   Fred 0.2500   NA -1.509606  TRUE
## 51   Fred 0.5000   NA -1.927679  TRUE
## 6    Fred 0.7500   NA -1.993190  TRUE
## 7    Fred 1.0000   NA -1.931097  TRUE
## 8    Fred 1.2500   NA -2.127528  TRUE
## 9    Fred 1.5000   NA -2.226257  TRUE
## 10   Fred 2.0000   NA -2.335475  TRUE
## 11   Fred 3.0000   NA  4.564589  TRUE</code></pre>
<p>The figure below plots the observed data (five blue points) and the broken stick predictions (red points) for Fred.</p>
<hr>
<p>Thus, based on the data up to 1.1 year, the model predicts that Fredâ€™s growth curve would remain around -2.0 SD until Fred is 1.5 years, and then would increase to -1.5 SD.</p>
</div>
<div id="predict-values-all-children-in-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#predict-values-all-children-in-the-model" class="anchor"></a>Predict values, all children in the model</h2>
<p>If we have access to the <code>brokenstick</code> object, prediction of cases used in the fitting process is straightforward.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="co"># if we have access to the brokenstick object</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">p</span>, <span class="fl">3</span>)</pre></body></html></div>
<pre><code>##   subjid      x     y      yhat  knot
## 1  10001 0.0000 0.575 0.5117682 FALSE
## 2  10001 0.0821 0.888 0.8762757 FALSE
## 3  10001 0.1588 0.797 0.8107744 FALSE</code></pre>
<p>The <code>brokenstick_export</code> object does not store the individual data, but if we have the data stored in another place (here <code>data</code>), we may obtain predictions as follows:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="co"># case-by-case prediction on external data </span>
<span class="no">ds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="no">data</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="no">data</span>$<span class="no">subjid</span>, <span class="kw">drop</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">result</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ds</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="no">ds</span>)) {
  <span class="no">d</span> <span class="kw">&lt;-</span> <span class="no">ds</span><span class="kw">[[</span><span class="no">i</span>]]
  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">d</span>) <span class="kw">&gt;</span> <span class="fl">0</span>) <span class="no">result</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">exp</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">d</span>$<span class="no">hgt.z</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">d</span>$<span class="no">age</span>, <span class="kw">subjid</span> <span class="kw">=</span> <span class="no">d</span>$<span class="no">subjid</span>[<span class="fl">1</span>])
}
<span class="no">result</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">result</span>)
<span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span>(<span class="no">result</span>) <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">result</span>)

<span class="co"># check that we get the same answers</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(<span class="no">result</span>, <span class="no">p</span>)</pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="assess-quality-of-prediction-z-scale" class="section level2">
<h2 class="hasAnchor">
<a href="#assess-quality-of-prediction-z-scale" class="anchor"></a>Assess quality of prediction (<span class="math inline">\(Z\)</span>-scale)</h2>
<p>The scatterplot of the observed versus predicted values indicates an extremely accurate prediction.</p>
<p><img src="prediction_files/figure-html/unnamed-chunk-18-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The correlation is to 0.9938. The standard deviation of the residuals is equal to 0.113, a small value in the <span class="math inline">\(Z\)</span>-scale.</p>
</div>
<div id="assess-quality-of-prediction-cm-scale" class="section level2">
<h2 class="hasAnchor">
<a href="#assess-quality-of-prediction-cm-scale" class="anchor"></a>Assess quality of prediction (cm scale)</h2>
<p>When back-converted to centimeters, the scatterplot of the observed versus predicted values is even a little tighter.</p>
<!-- The correlation is to r round(cor(y_cm, yhat_cm, use = "complete.obs"), 4). The standard deviation of the residuals is equal to r round(sd(y_cm - yhat_cm, na.rm = TRUE), 3) cm, which is very small.  -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stef van Buuren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
