<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict from a <code>brokenstick</code> model — predict.brokenstick • brokenstick</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict from a <code>brokenstick</code> model — predict.brokenstick" />
<meta property="og:description" content="The predictions from a broken stick model coincide with the
group-conditional means of the random effects. This function takes
an object of class brokenstick and returns predictions
in one of several formats. The user can calculate predictions
for new persons, i.e., for persons who are not part of
the fitted model, through the x and y arguments." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brokenstick</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.71.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gettingstarted.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/knotplacement.html">Knot placement</a>
    </li>
    <li>
      <a href="../articles/mainfunctions.html">Overview of main functions</a>
    </li>
    <li>
      <a href="../articles/model.html">Model formulation</a>
    </li>
    <li>
      <a href="../articles/oldfriends.html">Help for old friends</a>
    </li>
    <li>
      <a href="../articles/perfectmodel.html">Check perfect model</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Fit and predict</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stefvanbuuren/brokenstick/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict from a <code>brokenstick</code> model</h1>
    <small class="dont-index">Source: <a href='https://github.com/stefvanbuuren/brokenstick/blob/master/R/brokenstick-predict.R'><code>R/brokenstick-predict.R</code></a></small>
    <div class="hidden name"><code>predict.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The predictions from a broken stick model coincide with the
group-conditional means of the random effects. This function takes
an object of class <code>brokenstick</code> and returns predictions
in one of several formats. The user can calculate predictions
for new persons, i.e., for persons who are not part of
the fitted model, through the <code>x</code> and <code>y</code> arguments.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for brokenstick</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(
  <span class='no'>object</span>,
  <span class='kw'>new_data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"numeric"</span>,
  <span class='no'>...</span>,
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>strip_data</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"long"</span>, <span class='st'>"wide"</span>, <span class='st'>"vector"</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <code>brokenstick</code> object.</p></td>
    </tr>
    <tr>
      <th>new_data</th>
      <td><p>A data frame or matrix of new predictors.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A single character. The type of predictions to generate.
Valid options are:</p><ul>
<li><p><code>"numeric"</code> for numeric predictions.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not used, but required for extensibility.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Optional. A numeric vector with values of the predictor. It could
also be the special keyword <code>x = "knots"</code> replaces <code>x</code> by the
positions of the knots.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Optional. A numeric vector with measurements.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A vector with group identifications</p></td>
    </tr>
    <tr>
      <th>strip_data</th>
      <td><p>A logical indicating whether the row with the
observed data from <code>new_data</code> should be stripped from the
return. The default is <code>TRUE</code>. Set to <code>FALSE</code> to infer which data
points are extracted from <code>new_data</code>.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>A string: <code>"long"</code> (default), <code>"wide"</code> or <code>"vector"</code>
specifying the shape of the return value. Note that use of <code>"wide"</code>
with many unique values in <code>x</code> creates an unwieldy, large
and sparse matrix.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble of predictions. If <code>x</code>, <code>y</code> and <code>group</code> are not specified,
the number of rows in the tibble is guaranteed to be the same as
the number of rows in <code>new_data</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>By default, <code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code> calculates predictions for every row in
<code>new_data</code>. It is possible to tailor the behavior through the
<code>x</code>, <code>y</code> and <code>group</code> arguments. What exactly happens depends on
which of these arguments is specified:</p><ol>
<li><p>If the user specifies <code>x</code>, but no <code>y</code> and <code>group</code>, the function
returns - for every group in <code>new_data</code> - predictions at <code>x</code>
values. This method will use the data from <code>new_data</code>.</p></li>
<li><p>If the user specifies <code>x</code> and <code>y</code> but no <code>group</code>, the function
forms a hypothetical new group with the <code>x</code> and <code>y</code> values. This
method uses no information from <code>new_data</code>.</p></li>
<li><p>If the user specifies <code>group</code>, but no <code>x</code> or <code>y</code>, the function
searches for the relevant data in <code>new_data</code> and limits its
predictions to the specified groups. This is useful if prediction
for only one or a few groups is needed.</p></li>
<li><p>If the user specifies <code>x</code> and <code>group</code>, but no <code>y</code>, the function
will create new values for <code>x</code> in each group, search for the relevant
data in <code>new_data</code> and limit prediction to locations <code>x</code> in those
groups.</p></li>
<li><p>If the user specifies <code>x</code>, <code>y</code> and <code>group</code>, the functions
assumes that these vectors form a data frame. The lengths of <code>x</code>,
<code>y</code> and <code>group</code> must be the same. This procedure uses only
information from <code>newdata</code> for groups with <code>group</code> values that match
those on <code>newdata</code>.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>train</span> <span class='kw'>&lt;-</span> <span class='no'>smocc_200</span>[<span class='fl'>1</span>:<span class='fl'>1198</span>, ]
<span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='no'>smocc_200</span>[<span class='fl'>1199</span>:<span class='fl'>1940</span>, ]

<span class='co'># Fit</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brokenstick.html'>brokenstick</a></span>(<span class='no'>hgt.z</span> ~ <span class='no'>age</span> <span class='kw'>|</span> <span class='no'>id</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>train</span>, <span class='kw'>knots</span> <span class='kw'>=</span> <span class='fl'>0</span>:<span class='fl'>3</span>)

<span class='co'># Predict, with preprocessing</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>)</div><div class='output co'>#&gt; # A tibble: 742 x 1
#&gt;    .pred
#&gt;    &lt;dbl&gt;
#&gt;  1 0.319
#&gt;  2 0.325
#&gt;  3 0.332
#&gt;  4 0.342
#&gt;  5 0.362
#&gt;  6 0.387
#&gt;  7 0.406
#&gt;  8 0.386
#&gt;  9 0.356
#&gt; 10 0.322
#&gt; # … with 732 more rows</div><div class='input'>
<span class='co'># case 1: x as knots</span>
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"knots"</span>)

<span class='co'># case 2: x and y, one new group</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"knots"</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='fl'>0</span>))</div><div class='output co'>#&gt;   .source age hgt.z id     .pred
#&gt; 1   added   0   1.0  0 0.8758366
#&gt; 2   added   1   1.0  0 0.7024850
#&gt; 3   added   2   0.5  0 0.5955456
#&gt; 4   added   3   0.0  0 0.0729350</div><div class='input'>
<span class='co'># case 2: x and y, one new group, we need not specify new_data</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='st'>"knots"</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='fl'>0</span>))</div><div class='output co'>#&gt;   .source age hgt.z id     .pred
#&gt; 1   added   0   1.0  0 0.8758366
#&gt; 2   added   1   1.0  0 0.7024850
#&gt; 3   added   2   0.5  0 0.5955456
#&gt; 4   added   3   0.0  0 0.0729350</div><div class='input'>
<span class='co'># case 3: only group</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>11045</span>, <span class='fl'>11120</span>, <span class='fl'>999</span>))</div><div class='output co'>#&gt; # A tibble: 0 x 9
#&gt; # … with 9 variables: .source &lt;chr&gt;, id &lt;dbl&gt;, age &lt;dbl&gt;, sex &lt;chr&gt;, ga &lt;dbl&gt;,
#&gt; #   bw &lt;dbl&gt;, hgt &lt;dbl&gt;, hgt.z &lt;dbl&gt;, .pred &lt;dbl&gt;</div><div class='input'>
<span class='co'># case 4: predict at x in selected groups</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.25</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>11045</span>, <span class='fl'>11120</span>, <span class='fl'>999</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   .source    id   age sex      ga    bw   hgt hgt.z  .pred
#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1 added   11045  0.5  &lt;NA&gt;     NA    NA    NA    NA -0.440
#&gt; 2 added   11045  1    &lt;NA&gt;     NA    NA    NA    NA -0.620
#&gt; 3 added   11045  1.25 &lt;NA&gt;     NA    NA    NA    NA -0.561
#&gt; 4 added   11120  0.5  &lt;NA&gt;     NA    NA    NA    NA -1.84 
#&gt; 5 added   11120  1    &lt;NA&gt;     NA    NA    NA    NA -1.88 
#&gt; 6 added   11120  1.25 &lt;NA&gt;     NA    NA    NA    NA -1.92 </div><div class='input'>
<span class='co'># case 5: vectorized</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='no'>test</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.25</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>11045</span>, <span class='fl'>11120</span>, <span class='fl'>999</span>))</div><div class='output co'>#&gt; # A tibble: 3 x 9
#&gt;   .source    id   age sex      ga    bw   hgt hgt.z  .pred
#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1 added   11045  0.5  &lt;NA&gt;     NA    NA    NA   0   -0.389
#&gt; 2 added   11120  1    &lt;NA&gt;     NA    NA    NA   0.5 -1.40 
#&gt; 3 added     999  1.25 &lt;NA&gt;     NA    NA    NA   1    0.798</div><div class='input'>
<span class='co'># case 5: vectorized, without new_data, results are different for 11045 and 11120</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.25</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>), <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>11045</span>, <span class='fl'>11120</span>, <span class='fl'>999</span>))</div><div class='output co'>#&gt;   .source  age hgt.z    id        .pred
#&gt; 1   added 0.50   0.0 11045 0.0009576034
#&gt; 2   added 1.00   0.5 11120 0.4030588876
#&gt; 3   added 1.25   1.0   999 0.7977639528</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stef van Buuren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


