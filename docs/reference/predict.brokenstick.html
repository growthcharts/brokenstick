<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict growth curve according to the broken stick model — predict.brokenstick • brokenstick</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict growth curve according to the broken stick model — predict.brokenstick" />
<meta property="og:description" content="Calculation predictions (conditional means of the random effects) from the
broken stick model. This function takes an object of class
brokenstick, and returns predictions in one of several formats. We may
calculate predictions for new persons, i.e., for persons who are not part of
the fitted model, by specifying the x and y arguments." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brokenstick</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.62.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gettingstarted.html">Getting started with `brokenstick`</a>
    </li>
    <li>
      <a href="../articles/knotplacement.html">Knot placement</a>
    </li>
    <li>
      <a href="../articles/mainfunctions.html">Overview of main functions</a>
    </li>
    <li>
      <a href="../articles/model.html">Model formulation</a>
    </li>
    <li>
      <a href="../articles/perfectmodel.html">Check perfect model</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Fit and predict</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stefvanbuuren/brokenstick/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict growth curve according to the broken stick model</h1>
    <small class="dont-index">Source: <a href='https://github.com/stefvanbuuren/brokenstick/blob/master/R/predict.R'><code>R/predict.R</code></a></small>
    <div class="hidden name"><code>predict.brokenstick.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculation predictions (conditional means of the random effects) from the
broken stick model. This function takes an object of class
<code>brokenstick</code>, and returns predictions in one of several formats. We may
calculate predictions for new persons, i.e., for persons who are not part of
the fitted model, by specifying the <code>x</code> and <code>y</code> arguments.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for brokenstick</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>object</span>, <span class='no'>y</span>, <span class='no'>x</span>, <span class='kw'>ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>at</span> <span class='kw'>=</span> <span class='st'>"x"</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"long"</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>brokenstick</code> or of class
<code>brokenstick_export</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A vector with measurements using the same response scale as the
fitted model.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A vector with decimal ages of length <code><a href='https://rdrr.io/r/base/length.html'>length(y)</a></code>.
If both <code>y</code> and <code>x</code> are not specified,
  the function calculates the predicted values for all persons on which
  <code>object</code> was fitted. If <code>y</code> is not specified, but <code>x</code> is,
  then broken stick estimates are obtained at <code>x</code> for all persons in
  <code>object</code>. Note that the <code>at = "x"</code> argument is needed to make
  predictions at the <code>x</code> values.</p></td>
    </tr>
    <tr>
      <th>ids</th>
      <td><p>A vector with one or more subject identification codes.</p></td>
    </tr>
    <tr>
      <th>at</th>
      <td><p>If <code>at = "x"</code> (the default) the function returns
predictions at the <code>x</code> values in the data. Specify <code>at =
"knots"</code> to obtain predictions at the knots of the model, or
<code>at = "both"</code> to obtain both.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>A string specifying the desired type of output. If <code>output
= "long"</code> (the default), the result is cast into a data frame of the long
format that represents each row represented as an observation. If
<code>output = "broad"</code>, the result is formed into a broad matrix where
each row represents a person. This format is useful as input to a secondary
data analysis that analyzes the smoothed data as repeated measured. The
format can be used if <code>at = "knots"</code>, and returns <code>NULL</code>
otherwise. If <code>output = "vector"</code>, the result is returned as a vector.
This is the fastest method.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed down to <code>predict.merMod()</code>,
<code><a href='predict.brokenstick_export.html'>predict.brokenstick_export()</a></code> and <code>predict_all()</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>output == "long"</code>, a data frame with five columns named:</p><dl'>
  <dt><code>subjid</code></dt><dd><p>Person identification</p></dd>
  <dt><code>x</code></dt><dd><p>The <code>x</code> values of the model, usually age</p></dd>
  <dt><code>y</code></dt><dd><p>Response values (in scale defined by the model)</p></dd>
  <dt><code>yhat</code></dt><dd><p>Predicted values</p></dd>
  <dt><code>knot</code></dt><dd><p>Logical, TRUE indicates that the prediction is
  done at the location of the knot, or at a location specified by an
  isolated <code>x</code> argument, i.e., without a corresponding <code>y</code> argument.</p></dd>
  
</dl>

<p>If <code>output == "broad"</code>, a
  numeric matrix of predicted values with <code><a href='https://rdrr.io/r/base/length.html'>length(slot(object,
  "knots"))</a></code> columns. The number of rows will equal the number of
  <code>subjid</code>'s in the original data. Subject without any valid
  outcome will have <code>NA</code>'s everywhere.</p>
<p>If <code>output == "vector"</code>, a numeric vector of
  predicted values corresponding to the column <code>yhat</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The original data are only present in the <code>object</code> of class
  <code>brokenstick</code>. Hence, any calculations involving observations of the
  fitted model require an object of class <code>brokenstick</code>. Predictions for
  new units can be done both with class <code>brokenstick</code> and
  <code>brokenstick_export</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other brokenstick: 
<code><a href='fitted.brokenstick.html'>fitted.brokenstick</a>()</code>,
<code><a href='predict.brokenstick_export.html'>predict.brokenstick_export</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Estimates at each measured age for all persons in fitted model</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='no'>fit_200</span>)</div><div class='output co'>#&gt; [1] "brokenstick"</div><div class='input'><span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt;   subjid      x      y       yhat  knot
#&gt; 1  10001 0.0000  0.575  0.5705123 FALSE
#&gt; 2  10001 0.0821  0.888  0.8817845 FALSE
#&gt; 3  10001 0.1588  0.797  0.7415178 FALSE
#&gt; 4  10001 0.2546  0.661  0.6237670 FALSE
#&gt; 5  10001 0.5038  0.290  0.2870223 FALSE
#&gt; 6  10001 0.7529 -0.398 -0.2017717 FALSE</div><div class='input'>
<span class='co'># Estimates at knots, stored into the broad matrix</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"broad"</span>, <span class='kw'>at</span> <span class='kw'>=</span> <span class='st'>"knots"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>p</span>), <span class='fl'>2</span>)</div><div class='output co'>#&gt;           0 0.0833 0.1667  0.25   0.5  0.75     1  1.25   1.5     2     3
#&gt; 10001  0.57   0.89   0.73  0.63  0.29 -0.21  0.11  0.13 -0.18  0.15  0.58
#&gt; 10002 -0.19  -0.32  -0.25 -0.32 -0.24 -0.27 -0.33 -0.48 -0.50 -0.62 -1.24
#&gt; 10003  1.18   2.07   1.98  2.10  2.04  1.77  1.33  1.10  0.91  1.16 -1.09
#&gt; 10004  0.09   0.46   0.40  0.88  0.65  0.54  0.22 -0.08 -0.30 -0.14 -1.40
#&gt; 10005  1.47   1.75   1.29  0.98  1.12  1.08  1.61  2.30  2.16  2.06  3.66
#&gt; 10006 -0.60   0.07   0.03  0.39 -0.05 -0.13 -0.27  0.02  0.32  0.39  0.64</div><div class='input'>
<span class='co'># Get these estimates as a vector, useful for programming</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"vector"</span>, <span class='kw'>at</span> <span class='kw'>=</span> <span class='st'>"knots"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>p</span>), <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1]  0.57  0.89  0.73  0.63  0.29 -0.21</div><div class='input'>
<span class='co'># Obtain estimates at weeks 1-4 for all children, include old points</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>((<span class='fl'>1</span>:<span class='fl'>4</span>) * <span class='fl'>7</span> / <span class='fl'>365.25</span>, <span class='fl'>4</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt;   subjid      x      y       yhat  knot
#&gt; 1  10001 0.0000  0.575  0.5705123 FALSE
#&gt; 2  10001 0.0821  0.888  0.8817845 FALSE
#&gt; 3  10001 0.1588  0.797  0.7415178 FALSE
#&gt; 4  10001 0.2546  0.661  0.6237670 FALSE
#&gt; 5  10001 0.5038  0.290  0.2870223 FALSE
#&gt; 6  10001 0.7529 -0.398 -0.2017717 FALSE</div><div class='input'>
<span class='co'># Same, but now organised as broad matrix of new points only</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>((<span class='fl'>1</span>:<span class='fl'>4</span>) * <span class='fl'>7</span> / <span class='fl'>365.25</span>, <span class='fl'>4</span>), <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"broad"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt;          0.0192     0.0383     0.0575     0.0767
#&gt; [1,]  0.6433067  0.7157221  0.7885166  0.8613111
#&gt; [2,] -0.2167395 -0.2465005 -0.2764174 -0.3063343
#&gt; [3,]  1.3833079  1.5882210  1.7942070  2.0001929
#&gt; [4,]  0.1735663  0.2602390  0.3473656  0.4344921
#&gt; [5,]  1.4673513  1.5327410  1.5977902  1.6631800
#&gt; [6,]  1.7285698 -0.4428583 -0.2899656 -0.1362724</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>at</span> <span class='kw'>=</span> <span class='st'>"knots"</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"broad"</span>), <span class='fl'>3</span>)</div><div class='output co'>#&gt;                0     0.0833     0.1667       0.25        0.5       0.75
#&gt; 10001  0.5705123  0.8863342  0.7263649  0.6299368  0.2946222 -0.2053723
#&gt; 10002 -0.1868226 -0.3166182 -0.2539699 -0.3235495 -0.2373094 -0.2746838
#&gt; 10003  1.1773219  2.0710006  1.9771740  2.1040238  2.0392138  1.7717735
#&gt;                1       1.25        1.5          2          3
#&gt; 10001  0.1050307  0.1289907 -0.1843961  0.1534859  0.5769778
#&gt; 10002 -0.3307353 -0.4821327 -0.4997825 -0.6162842 -1.2393416
#&gt; 10003  1.3284154  1.0965839  0.9079110  1.1596519 -1.0863068</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>fit_200</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10001</span>, <span class='fl'>10003</span>), <span class='kw'>at</span> <span class='kw'>=</span> <span class='st'>"knots"</span>, <span class='kw'>output</span> <span class='kw'>=</span> <span class='st'>"broad"</span>)</div><div class='output co'>#&gt;               0    0.0833    0.1667      0.25       0.5       0.75         1
#&gt; 10001 0.5705123 0.8863342 0.7263649 0.6299368 0.2946222 -0.2053723 0.1050307
#&gt; 10003 1.1773219 2.0710006 1.9771740 2.1040238 2.0392138  1.7717735 1.3284154
#&gt;            1.25        1.5         2          3
#&gt; 10001 0.1289907 -0.1843961 0.1534859  0.5769778
#&gt; 10003 1.0965839  0.9079110 1.1596519 -1.0863068</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stef van Buuren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


